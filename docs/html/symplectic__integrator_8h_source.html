<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SlowDown Algorithmic Regularization (SDAR): symplectic_integrator.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SlowDown Algorithmic Regularization (SDAR)
   </div>
   <div id="projectbrief">Algorithmic Regularization with slowdown method for integrating few-body motions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('symplectic__integrator_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">symplectic_integrator.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="symplectic__integrator_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="list_8h.html">Common/list.h</a>&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="particle__group_8h.html">Common/particle_group.h</a>&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="symplectic__step_8h.html">AR/symplectic_step.h</a>&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="force_8h.html">AR/force.h</a>&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="slow__down_8h.html">AR/slow_down.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AR_2profile_8h.html">AR/profile.h</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="information_8h.html">AR/information.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceAR.html">AR</a> {</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> Tmethod&gt;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html">   21</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html">TimeTransformedSymplecticManager</a> {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#a799160bafccc5988e5536a02000ec58a">   23</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a799160bafccc5988e5536a02000ec58a">time_error_max_real</a>; </div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#a9f6811189392b0ff828cab43124d413c">   24</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a9f6811189392b0ff828cab43124d413c">energy_error_relative_max</a>; </div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#ac5bd5371a46e342f8044178ae9dff05a">   25</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#ac5bd5371a46e342f8044178ae9dff05a">time_step_real_min</a>;        </div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#a11b8c70a74163d251c510aa51db8d758">   26</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a11b8c70a74163d251c510aa51db8d758">slowdown_pert_ratio_ref</a>;   </div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_MASSRATIO</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> slowdown_mass_ref;         </div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#af51100c5b050b9042150be1a0bb3a8e5">   30</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#af51100c5b050b9042150be1a0bb3a8e5">slowdown_timescale_max</a>;       </div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#a21bbe24b1e3ed94107a7532836352021">   31</a></span>&#160;        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a21bbe24b1e3ed94107a7532836352021">step_count_max</a>; </div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#a3c37e4d27a9a2828975d5c04175fc149">   32</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a3c37e4d27a9a2828975d5c04175fc149">interrupt_detection_option</a>;    </div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        </div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">   34</a></span>&#160;        Tmethod <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>; </div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">   35</a></span>&#160;        <a class="code" href="classAR_1_1SymplecticStep.html">SymplecticStep</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>;  </div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#a33031aee8edde0d51b0a38446beabb25">   38</a></span>&#160;        <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a33031aee8edde0d51b0a38446beabb25">TimeTransformedSymplecticManager</a>(): time_error_max_real(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(-1.0)), energy_error_relative_max(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(-1.0)), time_step_real_min(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(-1.0)), slowdown_pert_ratio_ref(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(-1.0)), </div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;#ifdef AR_SLOWDOWN_MASSRATIO</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                            slowdown_mass_ref(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(-1.0)), </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;#endif</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                            slowdown_timescale_max(0.0),</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                            step_count_max(-1), interrupt_detection_option(0), interaction(), step() {}</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#a8921a86541d095de3a8685f4aad2da48">   48</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8921a86541d095de3a8685f4aad2da48">checkParams</a>() {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="comment">//ASSERT(time_error_max_real&gt;ROUND_OFF_ERROR_LIMIT);</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            ASSERT(time_error_max_real&gt;0.0);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            ASSERT(energy_error_relative_max&gt;<a class="code" href="Float_8h.html#a853ff12111317b68c02ac40cb56c30b2">ROUND_OFF_ERROR_LIMIT</a>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="comment">//ASSERT(time_step_real_min&gt;ROUND_OFF_ERROR_LIMIT);</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            ASSERT(time_step_real_min&gt;0.0);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            ASSERT(slowdown_pert_ratio_ref&gt;0.0);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_MASSRATIO</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            ASSERT(slowdown_mass_ref&gt;0.0);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            ASSERT(slowdown_timescale_max&gt;0);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            ASSERT(step_count_max&gt;0);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            ASSERT(step.<a class="code" href="classAR_1_1SymplecticStep.html#a191a4dfa707aa4bbe6258c90c6ae80bc">getOrder</a>()&gt;0);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            ASSERT(interaction.checkParams());</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#ab360e8472572d3df9e5dcc5dcfa2a548">   68</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#ab360e8472572d3df9e5dcc5dcfa2a548">writeBinary</a>(FILE *_fout) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordtype">size_t</span> size = <span class="keyword">sizeof</span>(*this) - <span class="keyword">sizeof</span>(<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>) - <span class="keyword">sizeof</span>(step);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            fwrite(<span class="keyword">this</span>, size, 1,_fout);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            interaction.writeBinary(_fout);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            step.<a class="code" href="classAR_1_1SymplecticStep.html#ac690aed0e148f94b81c5b944de0c680f">writeBinary</a>(_fout);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#a468331841b3d06894c4fb450891c7c2e">   78</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a468331841b3d06894c4fb450891c7c2e">readBinary</a>(FILE *_fin) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordtype">size_t</span> size = <span class="keyword">sizeof</span>(*this) - <span class="keyword">sizeof</span>(<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>) - <span class="keyword">sizeof</span>(step);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keywordtype">size_t</span> rcount = fread(<span class="keyword">this</span>, size, 1, _fin);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">if</span> (rcount&lt;1) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: Data reading fails! requiring data number is 1, only obtain &quot;</span>&lt;&lt;rcount&lt;&lt;<span class="stringliteral">&quot;.\n&quot;</span>;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                abort();</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            interaction.readBinary(_fin);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            step.<a class="code" href="classAR_1_1SymplecticStep.html#a7bd554fb4782da4c8a5b56be01877273">readBinary</a>(_fin);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticManager.html#ad6ac699eac841ad74a329cb7087ed5aa">   90</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#ad6ac699eac841ad74a329cb7087ed5aa">print</a>(std::ostream &amp; _fout)<span class="keyword"> const</span>{</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            _fout&lt;&lt;<span class="stringliteral">&quot;time_error_max_real       : &quot;</span>&lt;&lt;time_error_max_real&lt;&lt;std::endl</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                 &lt;&lt;<span class="stringliteral">&quot;energy_error_relative_max : &quot;</span>&lt;&lt;energy_error_relative_max&lt;&lt;std::endl </div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                 &lt;&lt;<span class="stringliteral">&quot;time_step_real_min        : &quot;</span>&lt;&lt;time_step_real_min&lt;&lt;std::endl</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                 &lt;&lt;<span class="stringliteral">&quot;slowdown_pert_ratio_ref   : &quot;</span>&lt;&lt;slowdown_pert_ratio_ref&lt;&lt;std::endl</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_MASSRATIO</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                 &lt;&lt;<span class="stringliteral">&quot;slowdown_mass_ref         : &quot;</span>&lt;&lt;slowdown_mass_ref&lt;&lt;std::endl</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                 &lt;&lt;<span class="stringliteral">&quot;slowdown_timescale_max    : &quot;</span>&lt;&lt;slowdown_timescale_max&lt;&lt;std::endl</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                 &lt;&lt;<span class="stringliteral">&quot;step_count_max            : &quot;</span>&lt;&lt;step_count_max&lt;&lt;std::endl;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            interaction.print(_fout);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            step.<a class="code" href="classAR_1_1SymplecticStep.html#a19bd3176dd1b853e19023288d41ee532">print</a>(_fout);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    };</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> Tparticle, <span class="keyword">class</span> Tpcm, <span class="keyword">class</span> Tpert, <span class="keyword">class</span> Tmethod, <span class="keyword">class</span> Tinfo&gt;</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html">  114</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html">TimeTransformedSymplecticIntegrator</a> {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keyword">struct </span>SlowDownPair{</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <a class="code" href="classAR_1_1SlowDown.html">SlowDown</a> slowdown;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <a class="code" href="classCOMM_1_1BinaryTree.html">COMM::BinaryTree&lt;Tparticle&gt;</a>* bin;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        </div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            SlowDownPair(): slowdown(), bin(NULL) {}</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        };</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="comment">// intergrated variables</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> time_;   </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> etot_ref_; </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">// calculated varaiables</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ekin_;   </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> epot_;   </div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// cumulative slowdown (inner + outer) energy change</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> de_sd_change_cum_;  <span class="comment">// slowdown energy change</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dH_sd_change_cum_;  <span class="comment">// slowdown Hamiltonian change </span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ekin_sdi_;  </div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> epot_sdi_;  </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> etot_sdi_ref_;  </div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// transformation factors</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_drift_inv_;  </div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_kick_inv_;   </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">// force array</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="classCOMM_1_1List.html">COMM::List&lt;Force&gt;</a> force_; </div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a81522aaa0bf529c877d78ab4c831fb4e">  152</a></span>&#160;        <a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html">TimeTransformedSymplecticManager&lt;Tmethod&gt;</a>* <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a81522aaa0bf529c877d78ab4c831fb4e">manager</a>; </div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aa562a1c5d18cfff4c0c3fae32d6569fa">  153</a></span>&#160;        <a class="code" href="classCOMM_1_1ParticleGroup.html">COMM::ParticleGroup&lt;Tparticle,Tpcm&gt;</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aa562a1c5d18cfff4c0c3fae32d6569fa">particles</a>; </div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="classCOMM_1_1List.html">COMM::List&lt;SlowDownPair&gt;</a> slowdown_inner; </div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a1f220a59d9bd080161b6483fc11e843c">  157</a></span>&#160;        <a class="code" href="classAR_1_1SlowDown.html">SlowDown</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a1f220a59d9bd080161b6483fc11e843c">slowdown</a>; </div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a357fd0ba51c03e4fb25b7c7f86ab5ef7">  158</a></span>&#160;        Tpert    <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a357fd0ba51c03e4fb25b7c7f86ab5ef7">perturber</a>; </div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#af1a559da78388cde7e6a33bdb2ef9614">  159</a></span>&#160;        Tinfo    <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#af1a559da78388cde7e6a33bdb2ef9614">info</a>;   </div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5c45f143d6a385e8fcd353805cec2215">  160</a></span>&#160;        <a class="code" href="classAR_1_1Profile.html">Profile</a>  <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5c45f143d6a385e8fcd353805cec2215">profile</a>;  </div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        </div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a09592b94e586ce90b5c2826c930978f9">  163</a></span>&#160;        <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a09592b94e586ce90b5c2826c930978f9">TimeTransformedSymplecticIntegrator</a>(): time_(0), etot_ref_(0), ekin_(0), epot_(0), de_sd_change_cum_(0), dH_sd_change_cum_(0),</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;#ifdef AR_SLOWDOWN_INNER</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                ekin_sdi_(0), epot_sdi_(0), etot_sdi_ref_(0), </div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;#endif</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;#ifdef AR_TTL</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                gt_drift_inv_(0), gt_kick_inv_(0), </div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;#endif</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                force_(), manager(NULL), particles(), </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;#ifdef AR_SLOWDOWN_INNER</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                slowdown_inner(), </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;#endif</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                slowdown(), perturber(), info(), profile() {}</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a627ee2ed40338b50d6462c92ff08219f">  179</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a627ee2ed40338b50d6462c92ff08219f">checkParams</a>() {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            ASSERT(manager!=NULL);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            ASSERT(manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8921a86541d095de3a8685f4aad2da48">checkParams</a>());</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            ASSERT(perturber.checkParams());</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            ASSERT(info.checkParams());</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ac00641c72ad0f21c9796e8e6cb574530">  190</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ac00641c72ad0f21c9796e8e6cb574530">reserveIntegratorMem</a>() {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment">// force array always allocated local memory</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordtype">int</span> nmax = particles.<a class="code" href="classCOMM_1_1List.html#af3b49aeea643123fe2428af456c3fc77">getSizeMax</a>();</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            ASSERT(nmax&gt;0);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            force_.<a class="code" href="classCOMM_1_1List.html#a10c70f9a45d06c2589898cbaf1e4fbf8">setMode</a>(<a class="code" href="namespaceCOMM.html#aa0ca1c24dcb00331c6dca89a0a188fe3af5ddaf0ca7929578b408c909429f68f2">COMM::ListMode::local</a>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            force_.<a class="code" href="classCOMM_1_1List.html#a7f125554959409d40217deb7402c0de9">reserveMem</a>(nmax);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            slowdown_inner.<a class="code" href="classCOMM_1_1List.html#a10c70f9a45d06c2589898cbaf1e4fbf8">setMode</a>(<a class="code" href="namespaceCOMM.html#aa0ca1c24dcb00331c6dca89a0a188fe3af5ddaf0ca7929578b408c909429f68f2">COMM::ListMode::local</a>);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            slowdown_inner.<a class="code" href="classCOMM_1_1List.html#a7f125554959409d40217deb7402c0de9">reserveMem</a>(nmax/2);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aaa3a79d58bda3139dc300f0f46bff536">  205</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aaa3a79d58bda3139dc300f0f46bff536">clear</a>() {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            time_ = 0.0;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            etot_ref_ =0.0;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            ekin_ = 0.0;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            epot_ = 0.0;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            de_sd_change_cum_ = 0.0;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            dH_sd_change_cum_ = 0.0;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            ekin_sdi_ = 0.0;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            epot_sdi_ = 0.0;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            etot_sdi_ref_ = 0.0;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            gt_drift_inv_ = 0.0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            gt_kick_inv_ = 0.0;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            force_.<a class="code" href="classCOMM_1_1List.html#aceaeddd10f8a05984f25a258a48c2620">clear</a>();</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#affe5e5681cc87ff9c695059f68106c8c">clear</a>();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            slowdown_inner.<a class="code" href="classCOMM_1_1List.html#aceaeddd10f8a05984f25a258a48c2620">clear</a>();</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            slowdown.<a class="code" href="classAR_1_1SlowDown.html#a710d1c21a65f80a511a33ef3da325b33">clear</a>();</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            perturber.clear();</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            info.clear();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            profile.<a class="code" href="classAR_1_1Profile.html#a848512d98c7ca1339f490523414100b3">clear</a>();</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aab55b52156245634a8d78c7728b5c802">  233</a></span>&#160;        <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aab55b52156245634a8d78c7728b5c802">~TimeTransformedSymplecticIntegrator</a>() {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            clear();</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aa655bbfc4e9f9af1ae7f7a09fc193443">  240</a></span>&#160;        <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html">TimeTransformedSymplecticIntegrator</a>&amp; operator = (<span class="keyword">const</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html">TimeTransformedSymplecticIntegrator</a>&amp; _sym) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            clear();</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            time_   = _sym.time_;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            etot_ref_   = _sym.etot_ref_;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            ekin_   = _sym.ekin_;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            epot_   = _sym.epot_;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            de_sd_change_cum_= _sym.de_sd_change_cum_;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            dH_sd_change_cum_= _sym.dH_sd_change_cum_;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            ekin_sdi_= _sym.ekin_sdi_;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            epot_sdi_= _sym.epot_sdi_;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            etot_sdi_ref_= _sym.etot_sdi_ref_;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            gt_drift_inv_ = _sym.gt_drift_inv_;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            gt_kick_inv_ = _sym.gt_kick_inv_;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            force_  = _sym.force_;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            manager = _sym.<a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a81522aaa0bf529c877d78ab4c831fb4e">manager</a>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            slowdown_inner = _sym.slowdown_inner;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            slowdown = _sym.<a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a1f220a59d9bd080161b6483fc11e843c">slowdown</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            particles = _sym.<a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aa562a1c5d18cfff4c0c3fae32d6569fa">particles</a>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            info = _sym.binarytree;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            profile = _sym.<a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5c45f143d6a385e8fcd353805cec2215">profile</a>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> calcEKin(){</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            ekin_ = <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(0.0);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> num = particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            Tparticle* pdat = particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;num; i++) {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> *vi=pdat[i].getVel();</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                ekin_ += 0.5 * pdat[i].mass * (vi[0]*vi[0]+vi[1]*vi[1]+vi[2]*vi[2]);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            calcEkinSlowDownInner(ekin_);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> correctAccPotGTKickInvSlowDownInner(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>&amp; _gt_kick_inv, <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>&amp; _epot) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordtype">int</span> n = slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_kick_inv_cor = 0.0;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> de = 0.0;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keyword">auto</span>&amp; sdi = slowdown_inner[i];</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                ASSERT(sdi.bin!=NULL);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="keywordtype">int</span> i1 = sdi.bin-&gt;getMemberIndex(0);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                <span class="keywordtype">int</span> i2 = sdi.bin-&gt;getMemberIndex(1);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa = sdi.slowdown.getSlowDownFactor();</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="keywordflow">if</span> (i1&gt;=0) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    ASSERT(i2&gt;=0);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    ASSERT(i1!=i2);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    ASSERT(i1&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>());</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    ASSERT(i2&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>());</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    <span class="comment">// calculate pair interaction</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    <a class="code" href="structAR_1_1Force.html">Force</a> fi[2];</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> epoti;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_kick_inv_i = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcInnerAccPotAndGTKickInvTwo(fi[0], fi[1], epoti, particles[i1], particles[i2]);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa_inv = 1.0/kappa;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    <span class="comment">// scale binary pair force with slowdown </span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    force_[i1].acc_in[0] += fi[0].acc_in[0]*kappa_inv - fi[0].acc_in[0];</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    force_[i1].acc_in[1] += fi[0].acc_in[1]*kappa_inv - fi[0].acc_in[1];</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    force_[i1].acc_in[2] += fi[0].acc_in[2]*kappa_inv - fi[0].acc_in[2];</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    force_[i2].acc_in[0] += fi[1].acc_in[0]*kappa_inv - fi[1].acc_in[0];</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    force_[i2].acc_in[1] += fi[1].acc_in[1]*kappa_inv - fi[1].acc_in[1];</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    force_[i2].acc_in[2] += fi[1].acc_in[2]*kappa_inv - fi[1].acc_in[2];</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    de += epoti*kappa_inv - epoti;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <span class="comment">// scale gtgrad with slowdown</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor">#ifdef AR_TTL_GT_BINARY_INNER</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    force_[i1].gtgrad[0] = fi[0].gtgrad[0]*kappa_inv;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    force_[i1].gtgrad[1] = fi[0].gtgrad[1]*kappa_inv;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    force_[i1].gtgrad[2] = fi[0].gtgrad[2]*kappa_inv;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    force_[i2].gtgrad[0] = fi[1].gtgrad[0]*kappa_inv;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    force_[i2].gtgrad[1] = fi[1].gtgrad[1]*kappa_inv;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    force_[i2].gtgrad[2] = fi[1].gtgrad[2]*kappa_inv;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    gt_kick_inv_cor += kappa_inv*gt_kick_inv_i;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    force_[i1].gtgrad[0] += fi[0].gtgrad[0]*kappa_inv - fi[0].gtgrad[0];</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    force_[i1].gtgrad[1] += fi[0].gtgrad[1]*kappa_inv - fi[0].gtgrad[1];</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    force_[i1].gtgrad[2] += fi[0].gtgrad[2]*kappa_inv - fi[0].gtgrad[2];</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    force_[i2].gtgrad[0] += fi[1].gtgrad[0]*kappa_inv - fi[1].gtgrad[0];</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    force_[i2].gtgrad[1] += fi[1].gtgrad[1]*kappa_inv - fi[1].gtgrad[1];</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    force_[i2].gtgrad[2] += fi[1].gtgrad[2]*kappa_inv - fi[1].gtgrad[2];</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    <span class="comment">// gt kick</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    gt_kick_inv_cor += gt_kick_inv_i*(kappa_inv - 1.0);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    <span class="comment">// gt kick</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    gt_kick_inv_cor += gt_kick_inv_i*(kappa_inv - 1.0);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            epot_sdi_ = epot_ + de;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">#ifdef AR_TTL_GT_BINARY_INNER</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="keywordflow">if</span>(gt_kick_inv_cor!=0.0) _gt_kick_inv = gt_kick_inv_cor;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            _gt_kick_inv += gt_kick_inv_cor;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> correctPosSlowDownInner(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _dt) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordtype">int</span> n = slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keyword">auto</span>&amp; sdi = slowdown_inner[i];</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                ASSERT(sdi.bin!=NULL);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa = sdi.slowdown.getSlowDownFactor();</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa_inv_m_one = 1.0/kappa - 1.0;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* velcm = sdi.bin-&gt;getVel();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;2; k++) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    <span class="keywordtype">int</span> j = sdi.bin-&gt;getMemberIndex(k);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    ASSERT(j&gt;=0&amp;&amp;j&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>());</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pos = particles[j].getPos();</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel = particles[j].getVel();</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    <span class="comment">// only scale velocity referring to binary c.m.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> vrel[3] = { vel[0] - velcm[0], </div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                      vel[1] - velcm[1], </div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                      vel[2] - velcm[2]}; </div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    pos[0] += _dt * vrel[0] * kappa_inv_m_one;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    pos[1] += _dt * vrel[1] * kappa_inv_m_one;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    pos[2] += _dt * vrel[2] * kappa_inv_m_one;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> correctDGTInvSlowDownInner(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>&amp; _dgt, <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _dt) {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="keywordtype">int</span> n = slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dg = <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(0.0);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="keyword">auto</span>&amp; sdi = slowdown_inner[i];</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                ASSERT(sdi.bin!=NULL);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa = sdi.slowdown.getSlowDownFactor();</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa_inv = 1.0/kappa;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* velcm = sdi.bin-&gt;getVel();</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;2; k++) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    <span class="keywordtype">int</span> j = sdi.bin-&gt;getMemberIndex(k);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    <span class="keywordflow">if</span> (j&gt;=0) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        ASSERT(j&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>());</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* gtgrad=force_[j].gtgrad;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel = particles[j].getVel();</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> vrel[3] = { vel[0] - velcm[0], </div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                          vel[1] - velcm[1], </div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                          vel[2] - velcm[2]}; </div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#ifdef AR_TTL_GT_BINARY_INNER</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        dg +=  ((vrel[0] * kappa_inv + velcm[0])* gtgrad[0] +</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                (vrel[1] * kappa_inv + velcm[1])* gtgrad[1] +</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                (vrel[2] * kappa_inv + velcm[2])* gtgrad[2]);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        dg +=  (vrel[0] * (kappa_inv-1)* gtgrad[0] +</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                vrel[1] * (kappa_inv-1)* gtgrad[1] +</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                vrel[2] * (kappa_inv-1)* gtgrad[2]);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">#ifdef AR_TTL_GT_BINARY_INNER</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            _dgt = _dt*dg;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            _dgt += _dt*dg;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> updateCenterOfMassForBinaryWithSlowDownInner() {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordtype">int</span> n = slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="keyword">auto</span>&amp; sdi = slowdown_inner[i];</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordtype">int</span> i1 = sdi.bin-&gt;getMemberIndex(0);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="keywordtype">int</span> i2 = sdi.bin-&gt;getMemberIndex(1);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                ASSERT(i1&gt;=0&amp;&amp;i1&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>());</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                ASSERT(i2&gt;=0&amp;&amp;i2&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>());</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>    m1 = particles[i1].mass;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pos1 = particles[i1].getPos();</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel1 = particles[i1].getVel();</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>    m2 = particles[i2].mass;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pos2 = particles[i2].getPos();</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel2 = particles[i2].getVel();</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>   mcm = m1+m2;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="comment">// first obtain the binary c.m. velocity</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> mcminv = 1.0/mcm;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                sdi.bin-&gt;mass = mcm;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pos = sdi.bin-&gt;getPos();</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                pos[0] = (m1*pos1[0] + m2*pos2[0])*mcminv;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                pos[1] = (m1*pos1[1] + m2*pos2[1])*mcminv;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                pos[2] = (m1*pos1[2] + m2*pos2[2])*mcminv;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel = sdi.bin-&gt;getVel();</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                vel[0] = (m1*vel1[0] + m2*vel2[0])*mcminv;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                vel[1] = (m1*vel1[1] + m2*vel2[1])*mcminv;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                vel[2] = (m1*vel1[2] + m2*vel2[2])*mcminv;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> calcEkinSlowDownInner(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>&amp; _ekin) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordtype">int</span> n = slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> de = <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(0.0);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="keyword">auto</span>&amp; sdi = slowdown_inner[i];</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                ASSERT(sdi.bin!=NULL);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa = sdi.slowdown.getSlowDownFactor();</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa_inv_m_one = 1.0/kappa - 1.0;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* velcm = sdi.bin-&gt;getVel();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;2; k++) {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    <span class="keywordtype">int</span> j = sdi.bin-&gt;getMemberIndex(k);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    ASSERT(j&gt;=0&amp;&amp;j&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>());</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel = particles[j].getVel();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    <span class="comment">// only scale velocity referring to binary c.m.</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> vrel[3] = { vel[0] - velcm[0], </div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                      vel[1] - velcm[1], </div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                      vel[2] - velcm[2]}; </div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    de += kappa_inv_m_one * particles[j].mass * (vrel[0]*vrel[0] + vrel[1]*vrel[1] + vrel[2]*vrel[2]);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            ekin_sdi_ = _ekin + 0.5*de;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">int</span> findSlowDownInnerBinaryIter(<a class="code" href="classCOMM_1_1List.html">COMM::List&lt;SlowDownPair&gt;</a>&amp; _slowdown_inner, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; _c1, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; _c2, <a class="code" href="classCOMM_1_1BinaryTree.html">COMM::BinaryTree&lt;Tparticle&gt;</a>&amp; _bin) {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="comment">// find leaf binary</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordflow">if</span> (_bin.<a class="code" href="classCOMM_1_1BinaryTree.html#ae05cbd6fc87aebd60f87fa37db6ed2a2">getMemberN</a>()==2 &amp;&amp; _bin.<a class="code" href="classCOMM_1_1Binary.html#a62fdf14365f58412fde6199a31f87152">semi</a>&gt;0.0) {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                _slowdown_inner.<a class="code" href="classCOMM_1_1List.html#a610a134731844b13df4b22ef0d9ad603">increaseSizeNoInitialize</a>(1);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="keyword">auto</span>&amp; sdi_new = _slowdown_inner.<a class="code" href="classCOMM_1_1List.html#abcdc25c6ecaf2d352583fa75f9fa1180">getLastMember</a>();</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                sdi_new.bin = &amp;_bin;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="keywordflow">return</span> _c1+_c2+1;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">return</span> _c1+_c2;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordtype">void</span> findSlowDownInner(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _time) {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keyword">auto</span>&amp; bin_root = info.getBinaryTreeRoot();</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            slowdown_inner.<a class="code" href="classCOMM_1_1List.html#a0f3dd09ceff0ce9b3ffd15f48a9ea9c4">resizeNoInitialize</a>(0);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordtype">int</span> ncount[2]={0,0};</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="keywordtype">int</span> nsd = bin_root.processTreeIter(slowdown_inner, ncount[0], ncount[1], findSlowDownInnerBinaryIter);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            ASSERT(nsd==slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>());</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nsd; i++) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_MASSRATIO</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> mass_ratio = manager-&gt;slowdown_mass_ref/slowdown_inner[i].bin-&gt;mass;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#else </span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> mass_ratio = 1.0;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                slowdown_inner[i].slowdown.initialSlowDownReference(mass_ratio*manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a11b8c70a74163d251c510aa51db8d758">slowdown_pert_ratio_ref</a>, manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#af51100c5b050b9042150be1a0bb3a8e5">slowdown_timescale_max</a>);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                slowdown_inner[i].slowdown.setUpdateTime(time_);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordtype">void</span> calcSlowDownInnerAndCorrectGTInvEnergy(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _time) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="keywordtype">int</span> n = slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="keywordtype">bool</span> modified_flag=<span class="keyword">false</span>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <span class="keyword">auto</span>&amp; sdi = slowdown_inner[i];</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                <span class="comment">//if (_time&gt;=sdi.slowdown.getUpdateTime()) {</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                sdi.bin-&gt;calcCenterOfMass();</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcSlowDownInnerBinary(sdi.slowdown, slowdown, *sdi.bin, particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>(), particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>());</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                sdi.slowdown.increaseUpdateTimeOnePeriod();</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                modified_flag=<span class="keyword">true</span>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <span class="comment">//}</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            }    </div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="comment">// correct the initial gt_drift_inv_ for next integration step is important to be consistent with TTL method.</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="keywordflow">if</span> (modified_flag) {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                <span class="comment">// back up old ekin_sdi and epot_sdi</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ekin_sdi_bk = ekin_sdi_;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> epot_sdi_bk = epot_sdi_;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_drift_inv_bk = gt_drift_inv_;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> etot_sdi_ref_bk = etot_sdi_ref_;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="comment">// initialize the gt_drift_inv_ with new slowdown factor</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">#ifdef AR_TTL_GT_BINARY_INNER</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_kick_inv_sdi = 0.0;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_kick_inv_sdi = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcAccPotAndGTKickInv(force_.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>(), epot_, particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>(), particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>(), particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>, perturber, slowdown.<a class="code" href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">getRealTime</a>());</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                correctAccPotGTKickInvSlowDownInner(gt_kick_inv_sdi, epot_);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                gt_drift_inv_ += gt_kick_inv_sdi - gt_kick_inv_;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                gt_kick_inv_ = gt_kick_inv_sdi;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="comment">// correct etot_sdi_ref_ with new slowdown</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                calcEkinSlowDownInner(ekin_);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> de_sdi = (ekin_sdi_ - ekin_sdi_bk) + (epot_sdi_ - epot_sdi_bk);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                etot_sdi_ref_ += de_sdi;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dH_sdi = (ekin_sdi_ + epot_sdi_)/gt_drift_inv_ - (ekin_sdi_bk + epot_sdi_bk)/gt_drift_inv_bk;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dH_sdi = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcH(ekin_sdi_ - etot_sdi_ref_, epot_sdi_) </div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    - manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcH(ekin_sdi_bk - etot_sdi_ref_bk, epot_sdi_bk);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                <span class="comment">// add slowdown change to the global slowdown energy</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa_inv = 1.0/slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>();</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                de_sd_change_cum_ += de_sdi*kappa_inv;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                dH_sd_change_cum_ += dH_sdi*kappa_inv;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> kickVel(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _dt) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> num = particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();            </div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            Tparticle* pdat = particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <a class="code" href="structAR_1_1Force.html">Force</a>* force = force_.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa = slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>();</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;num; i++) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <span class="comment">// kick velocity</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel = pdat[i].getVel();</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* acc = force[i].<a class="code" href="structAR_1_1Force.html#abcb2ed01aed7b8ce9e10c45a63bd9077">acc_in</a>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pert= force[i].<a class="code" href="structAR_1_1Force.html#ac66e6a67f66ab3e1d9fa811b83cd016a">acc_pert</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <span class="comment">// half dv </span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                vel[0] += _dt * (acc[0] + kappa*pert[0]);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                vel[1] += _dt * (acc[1] + kappa*pert[1]);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                vel[2] += _dt * (acc[2] + kappa*pert[2]);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> driftTimeAndPos(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _dt) {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="comment">// drift time </span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            time_ += _dt;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="comment">// update real time</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            slowdown.<a class="code" href="classAR_1_1SlowDown.html#a05cb058656662b84f4a2af3600916363">driftRealTime</a>(_dt);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="comment">// drift position</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> num = particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            Tparticle* pdat = particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;num; i++) {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pos = pdat[i].getPos();</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel = pdat[i].getVel();</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                pos[0] += _dt * vel[0];</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                pos[1] += _dt * vel[1];</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                pos[2] += _dt * vel[2];</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="comment">// correct postion drift due to inner binary slowdown</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            correctPosSlowDownInner(_dt);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keyword">inline</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> calcAccPotAndGTKickInv() {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_kick_inv = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcAccPotAndGTKickInv(force_.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>(), epot_, particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>(), particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>(), particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>, perturber, slowdown.<a class="code" href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">getRealTime</a>());            </div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">//#ifdef AR_DEBUG</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">//            // check c.m. force </span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">//            Force fcm;</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">//            Float mcm=0.0;</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">//            for (int i=0; i&lt;particles.getSize(); i++) {</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">//                for (int k=0; k&lt;3; k++) {</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">//                    fcm.acc_in[k] += particles[i].mass * force_[i].acc_in[k];</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">//                mcm += particles[i].mass;</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">//            for (int k=0; k&lt;3; k++) {</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">//                fcm.acc_in[k] /= mcm;</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">//                ASSERT(abs(fcm.acc_in[k])&lt;1e-10);</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">//#endif</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="comment">// inner slowdown binary acceleration</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            correctAccPotGTKickInvSlowDownInner(gt_kick_inv, epot_);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">//#ifdef AR_DEBUG</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">//            // check c.m. force </span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">//            fcm.acc_in[0] = fcm.acc_in[1] = fcm.acc_in[2] = 0.0;</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">//            for (int i=0; i&lt;particles.getSize(); i++) {</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">//                for (int k=0; k&lt;3; k++) {</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">//                    fcm.acc_in[k] += particles[i].mass * force_[i].acc_in[k];</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">//            for (int k=0; k&lt;3; k++) {</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">//                fcm.acc_in[k] /= mcm;</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">//                ASSERT(abs(fcm.acc_in[k])&lt;1e-10);</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">//#endif</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">return</span> gt_kick_inv;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> kickEtotAndGTDrift(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _dt) {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> de = <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(0.0);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dg = <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(0.0);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa = slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>();</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> num = particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            Tparticle* pdat = particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="structAR_1_1Force.html">Force</a>* force = force_.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;num;i++) {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>  mass= pdat[i].mass;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel = pdat[i].getVel();</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pert= force[i].<a class="code" href="structAR_1_1Force.html#ac66e6a67f66ab3e1d9fa811b83cd016a">acc_pert</a>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* gtgrad=force[i].gtgrad;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                de += mass * (vel[0] * kappa*pert[0] +</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                              vel[1] * kappa*pert[1] +</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                              vel[2] * kappa*pert[2]);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                dg +=  (vel[0] * gtgrad[0] +</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                        vel[1] * gtgrad[1] +</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                        vel[2] * gtgrad[2]);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            etot_ref_ += _dt * de;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dgt = _dt * dg;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            etot_sdi_ref_ += _dt * de;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            correctDGTInvSlowDownInner(dgt, _dt);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            gt_drift_inv_ += dgt;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keyword">inline</span> <span class="keywordtype">void</span> kickEtot(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _dt) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> de = 0.0;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa = slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>();</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> num = particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            Tparticle* pdat = particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <a class="code" href="structAR_1_1Force.html">Force</a>* force = force_.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;num;i++) {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>  mass= pdat[i].mass;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel = pdat[i].getVel();</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pert= force[i].<a class="code" href="structAR_1_1Force.html#ac66e6a67f66ab3e1d9fa811b83cd016a">acc_pert</a>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                de += mass * (vel[0] * kappa*pert[0] +</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                              vel[1] * kappa*pert[1] +</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                              vel[2] * kappa*pert[2]);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            etot_sdi_ref_ += _dt * de;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            etot_ref_ += _dt * de;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a4db984abe326fd1a30b3d52f6537e5eb">  742</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a4db984abe326fd1a30b3d52f6537e5eb">initialIntegration</a>(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _time_real) {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            ASSERT(<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8921a86541d095de3a8685f4aad2da48">checkParams</a>());</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="comment">// particle number and data address</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> n_particle = particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            Tparticle* particle_data = particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <span class="comment">// resize force array</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            force_.<a class="code" href="classCOMM_1_1List.html#a0f3dd09ceff0ce9b3ffd15f48a9ea9c4">resizeNoInitialize</a>(n_particle);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <a class="code" href="structAR_1_1Force.html">Force</a>* force_data = force_.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <span class="comment">// Initial intgrt value t (avoid confusion of real time when slowdown is used)</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            time_ = <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(0.0);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="comment">// slowdown initial time</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            slowdown.<a class="code" href="classAR_1_1SlowDown.html#a96bbb1913537669fc970a149028acdfd">setRealTime</a>(_time_real);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="comment">// check particle number</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            ASSERT(particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>()&gt;=2);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="comment">// reset particle modification flag</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            particles.<a class="code" href="classCOMM_1_1List.html#afe063c29e3ae8df95f65db67d7d8ba81">setModifiedFalse</a>();</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="comment">// check the center-of-mass initialization</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="keywordflow">if</span>(particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a04903afdcfee09b36b30600a2683c99e">isOriginFrame</a>()) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#ae6aeae77c0ba7d3fe9a48e55c8db4c82">calcCenterOfMass</a>();</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a46a5186631babb11c1be415ba740315d">shiftToCenterOfMassFrame</a>();</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            }</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="comment">// set slowdown reference</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_MASSRATIO</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> mass_ratio = manager-&gt;slowdown_mass_ref/particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>.mass;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">#else </span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> mass_ratio = 1.0;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            slowdown.<a class="code" href="classAR_1_1SlowDown.html#ab9436a956d9925171387b0cfe4ffbb0f">initialSlowDownReference</a>(mass_ratio*manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a11b8c70a74163d251c510aa51db8d758">slowdown_pert_ratio_ref</a>, manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#af51100c5b050b9042150be1a0bb3a8e5">slowdown_timescale_max</a>);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="comment">// slowdown for the system</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcSlowDownPert(slowdown, particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>, info.getBinaryTreeRoot(), perturber);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            gt_kick_inv_ = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcAccPotAndGTKickInv(force_data, epot_, particle_data, n_particle, particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>,  perturber, _time_real);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="comment">// initially gt_drift </span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            gt_drift_inv_ = gt_kick_inv_;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcAccPotAndGTKickInv(force_data, epot_, particle_data, n_particle, particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>,  perturber, _time_real);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="comment">// calculate kinetic energy</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            calcEKin();</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="comment">// initial total energy</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            etot_ref_ = ekin_ + epot_;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="comment">// add slowdown energy change due to turning on of slowdown.</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            de_sd_change_cum_ += etot_ref_/slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>() - etot_ref_;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            dH_sd_change_cum_ += etot_ref_*gt_drift_inv_*(1.0/slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>()-1.0);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            dH_sd_change_cum_ += manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcH(ekin_-etot_ref_, epot_)*(1.0/slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>()-1.0);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            <span class="comment">// initialize the energy with slowdown inner</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            ekin_sdi_ = ekin_;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            epot_sdi_ = epot_;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            etot_sdi_ref_ = etot_ref_;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="keywordflow">if</span> (particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>()&gt;2) {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                findSlowDownInner(time_);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                <span class="comment">// update c.m. of binaries </span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                updateCenterOfMassForBinaryWithSlowDownInner();</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <span class="comment">// calculate slowdown inner and correct gt and energy</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                calcSlowDownInnerAndCorrectGTInvEnergy(time_);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aef58e7b1ec25846a506b9b0281522a1f">  828</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aef58e7b1ec25846a506b9b0281522a1f">updateSlowDownAndCorrectEnergy</a>() {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="comment">//if (time_&gt;=slowdown.getUpdateTime()) {</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <span class="comment">// backup old slowdown factor</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> sd_old = slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>();</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcSlowDownPert(slowdown, particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>, info.getBinaryTreeRoot(), perturber);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="comment">// add energy change due to slowdown change</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> sd_new = slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>();</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            de_sd_change_cum_ += (1.0/sd_new-1.0/sd_old)*(ekin_sdi_ + epot_sdi_);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            dH_sd_change_cum_ += (1.0/sd_new-1.0/sd_old)*(ekin_sdi_ + epot_sdi_)/gt_drift_inv_;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            dH_sd_change_cum_ += (1.0/sd_new-1.0/sd_old)*manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcH(ekin_sdi_-etot_sdi_ref_, epot_sdi_);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            de_sd_change_cum_ += (1.0/sd_new-1.0/sd_old)*(ekin_ + epot_);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            dH_sd_change_cum_ += (1.0/sd_new-1.0/sd_old)*(ekin_ + epot_)/gt_drift_inv_;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            dH_sd_change_cum_ += (1.0/sd_new-1.0/sd_old)*manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcH(ekin_-etot_ref_, epot_);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            slowdown.<a class="code" href="classAR_1_1SlowDown.html#a43c4636ed1a5fe2acad80dfff75d0677">increaseUpdateTimeOnePeriod</a>();</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="comment">//}</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="comment">// inner binary slowdown</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            calcSlowDownInnerAndCorrectGTInvEnergy(time_);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#acb82fbf04578955d8dcf8035c0f97ee3">  863</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#acb82fbf04578955d8dcf8035c0f97ee3">integrateOneStep</a>(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _ds, <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _time_table[]) {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            ASSERT(<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8921a86541d095de3a8685f4aad2da48">checkParams</a>());</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            ASSERT(!particles.<a class="code" href="classCOMM_1_1List.html#aaddc8ba775e2a6504eb393d7d0c2235b">isModified</a>());</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            ASSERT(_ds&gt;0);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="comment">// symplectic step coefficent group n_particleber</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nloop = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getCDPairSize();</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nloop; i++) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                <span class="comment">// step for drift</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ds_drift = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getCK(i)*_ds;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                <span class="comment">// inverse time transformation factor for drift</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_drift_inv = gt_drift_inv_;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="preprocessor">#else </span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_drift_inv = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcGTDriftInv(ekin_sdi_-etot_sdi_ref_); <span class="comment">// pt = -etot</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_drift_inv = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcGTDriftInv(ekin_-etot_ref_); <span class="comment">// pt = -etot</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                <span class="comment">// drift</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dt_drift = ds_drift/gt_drift_inv;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                <span class="comment">// drift time and postion</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                driftTimeAndPos(dt_drift);</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                _time_table[i] = slowdown.<a class="code" href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">getRealTime</a>();</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                <span class="comment">// step for kick</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ds_kick = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getDK(i)*_ds;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_kick_inv = calcAccPotAndGTKickInv();</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                <span class="comment">// time step for kick</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dt_kick = ds_kick/gt_kick_inv;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="comment">// kick half step for velocity</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                kickVel(0.5*dt_kick);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor">#ifdef AR_TTL   </span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                <span class="comment">// back up gt_kick </span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                gt_kick_inv_ = gt_kick_inv;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                <span class="comment">// update c.m. of binaries </span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                updateCenterOfMassForBinaryWithSlowDownInner();</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                <span class="comment">// kick total energy and inverse time transformation factor for drift</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                kickEtotAndGTDrift(dt_kick);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <span class="comment">// kick total energy </span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                kickEtot(dt_kick);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <span class="comment">// kick half step for velocity</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                kickVel(0.5*dt_kick);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                </div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                <span class="comment">// update c.m. of binaries </span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                updateCenterOfMassForBinaryWithSlowDownInner();</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                <span class="comment">// calculate kinetic energy</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                calcEKin();</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        }</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aa9bc3285b782123da733df7d123a4ad6">  938</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aa9bc3285b782123da733df7d123a4ad6">integrateTwoOneStep</a>(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _ds, <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _time_table[]) {</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            ASSERT(<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8921a86541d095de3a8685f4aad2da48">checkParams</a>());</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            ASSERT(!particles.<a class="code" href="classCOMM_1_1List.html#aaddc8ba775e2a6504eb393d7d0c2235b">isModified</a>());</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            ASSERT(_ds&gt;0);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            <span class="comment">// symplectic step coefficent group number</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nloop = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getCDPairSize();</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            </div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> n_particle = particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            ASSERT(n_particle==2);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa = slowdown.<a class="code" href="classAR_1_1SlowDown.html#a7cae8bcc039bb158497e2f9bb6efbd78">calcSlowDownFactor</a>();</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            Tparticle* particle_data = particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> mass1 = particle_data[0].mass;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pos1 = particle_data[0].getPos();</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel1 = particle_data[0].getVel();</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> mass2 = particle_data[1].mass;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pos2 = particle_data[1].getPos();</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* vel2 = particle_data[1].getVel();</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <a class="code" href="structAR_1_1Force.html">Force</a>* force_data = force_.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* acc1 = force_data[0].<a class="code" href="structAR_1_1Force.html#abcb2ed01aed7b8ce9e10c45a63bd9077">acc_in</a>;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pert1= force_data[0].<a class="code" href="structAR_1_1Force.html#ac66e6a67f66ab3e1d9fa811b83cd016a">acc_pert</a>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* acc2 = force_data[1].<a class="code" href="structAR_1_1Force.html#abcb2ed01aed7b8ce9e10c45a63bd9077">acc_in</a>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* pert2= force_data[1].<a class="code" href="structAR_1_1Force.html#ac66e6a67f66ab3e1d9fa811b83cd016a">acc_pert</a>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* gtgrad1 = force_data[0].gtgrad;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* gtgrad2 = force_data[1].gtgrad;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nloop; i++) {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                <span class="comment">// step for drift</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ds = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getCK(i)*_ds;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="comment">// inverse time transformation factor for drift</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_inv = gt_drift_inv_;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="preprocessor">#else </span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_inv = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcGTDriftInv(ekin_-etot_ref_); <span class="comment">// pt = -etot</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                <span class="comment">// drift</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dt = ds/gt_inv;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                ASSERT(!isnan(dt));</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                </div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <span class="comment">// drift time </span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                time_ += dt;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                <span class="comment">// update real time</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                slowdown.<a class="code" href="classAR_1_1SlowDown.html#a05cb058656662b84f4a2af3600916363">driftRealTime</a>(dt);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                _time_table[i] = slowdown.<a class="code" href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">getRealTime</a>();</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                <span class="comment">// drift position</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                pos1[0] += dt * vel1[0];</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                pos1[1] += dt * vel1[1];</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                pos1[2] += dt * vel1[2];</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                pos2[0] += dt * vel2[0];</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                pos2[1] += dt * vel2[1];</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                pos2[2] += dt * vel2[2];</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                <span class="comment">// step for kick</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                ds = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getDK(i)*_ds;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                gt_inv = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcAccPotAndGTKickInv(force_data, epot_, particle_data, n_particle, particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>, perturber, _time_table[i]);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                ASSERT(!isnan(epot_));</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                <span class="comment">// time step for kick</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                dt = 0.5*ds/gt_inv;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                <span class="comment">// kick half step for velocity</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dvel1[3], dvel2[3];</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kpert1[3], kpert2[3];</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                kpert1[0] = kappa*pert1[0];</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                kpert1[1] = kappa*pert1[1];</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                kpert1[2] = kappa*pert1[2];</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                dvel1[0] = dt * (acc1[0] + kpert1[0]);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                dvel1[1] = dt * (acc1[1] + kpert1[1]);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                dvel1[2] = dt * (acc1[2] + kpert1[2]);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                vel1[0] += dvel1[0];</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                vel1[1] += dvel1[1];</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                vel1[2] += dvel1[2];</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                kpert2[0] = kappa*pert2[0];</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                kpert2[1] = kappa*pert2[1];</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                kpert2[2] = kappa*pert2[2];</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                dvel2[0] = dt * (acc2[0] + kappa*pert2[0]);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                dvel2[1] = dt * (acc2[1] + kappa*pert2[1]);</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                dvel2[2] = dt * (acc2[2] + kappa*pert2[2]);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                vel2[0] += dvel2[0];</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                vel2[1] += dvel2[1];</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                vel2[2] += dvel2[2];</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                <span class="comment">// kick total energy and time transformation factor for drift</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                etot_ref_ += 2.0*dt * (mass1* (vel1[0] * kpert1[0] + </div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                                               vel1[1] * kpert1[1] + </div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                               vel1[2] * kpert1[2]) +</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                                       mass2* (vel2[0] * kpert2[0] + </div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                               vel2[1] * kpert2[1] + </div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                               vel2[2] * kpert2[2]));</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="preprocessor">#ifdef AR_TTL   </span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                <span class="comment">// back up gt_kick_inv</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                gt_kick_inv_ = gt_inv;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                <span class="comment">// integrate gt_drift_inv</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                gt_drift_inv_ +=  2.0*dt* (vel1[0] * gtgrad1[0] +</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                           vel1[1] * gtgrad1[1] +</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                                           vel1[2] * gtgrad1[2] +</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                                           vel2[0] * gtgrad2[0] +</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                                           vel2[1] * gtgrad2[1] +</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                           vel2[2] * gtgrad2[2]);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                <span class="comment">// kick half step for velocity</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                vel1[0] += dvel1[0];</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                vel1[1] += dvel1[1];</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                vel1[2] += dvel1[2];</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                </div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                vel2[0] += dvel2[0];</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                vel2[1] += dvel2[1];</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                vel2[2] += dvel2[2];</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                </div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                <span class="comment">// calculate kinetic energy</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                ekin_ = 0.5 * (mass1 * (vel1[0]*vel1[0]+vel1[1]*vel1[1]+vel1[2]*vel1[2]) +</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                               mass2 * (vel2[0]*vel2[0]+vel2[1]*vel2[1]+vel2[2]*vel2[2]));</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            }</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="comment">// make consistent slowdown inner energy </span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            etot_sdi_ref_ = etot_ref_;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            ekin_sdi_ = ekin_;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            epot_sdi_ = epot_;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        </div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="comment">// Integrate the system to a given time</span></div><div class="line"><a name="l01086"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a24f338caf7308ceda28fcd7f8a223165"> 1086</a></span>&#160;<span class="comment"></span>        <a class="code" href="classCOMM_1_1BinaryTree.html">COMM::BinaryTree&lt;Tparticle&gt;</a>* <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a24f338caf7308ceda28fcd7f8a223165">integrateToTime</a>(<span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> _time_end_real) {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            ASSERT(<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8921a86541d095de3a8685f4aad2da48">checkParams</a>());</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keyword">using namespace </span>std::placeholders;  <span class="comment">// for _1, _2, _3...</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="comment">// real full time step</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dt_real_full = _time_end_real - slowdown.<a class="code" href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">getRealTime</a>();</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="comment">// time error </span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> time_error_real = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a799160bafccc5988e5536a02000ec58a">time_error_max_real</a>;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="comment">// energy error limit</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> energy_error_rel_max = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a9f6811189392b0ff828cab43124d413c">energy_error_relative_max</a>;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            <span class="comment">// expect energy_error using half step if energy_error_rel_max reached</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> energy_error_rel_max_half_step = energy_error_rel_max * manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.calcErrorRatioFromStepModifyFactor(0.5);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dt_real_min = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#ac5bd5371a46e342f8044178ae9dff05a">time_step_real_min</a>;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="comment">// backup data size</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> bk_data_size = getBackupDataSize();</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            </div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> backup_data[bk_data_size]; <span class="comment">// for backup chain data</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="preprocessor">#ifdef AR_DEBUG_DUMP</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> backup_data_init[bk_data_size]; <span class="comment">// for backup initial data</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            <span class="keywordtype">bool</span> backup_flag=<span class="keyword">true</span>; <span class="comment">// flag for backup or restore</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            <span class="comment">// time table</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> cd_pair_size = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getCDPairSize();</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> time_table[cd_pair_size]; <span class="comment">// for storing sub-integrated time </span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="comment">// step control</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ds[2] = {info.ds,info.ds}; <span class="comment">// step with a buffer</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ds_backup = info.ds;  <span class="comment">//backup step size</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ds_init   = info.ds;  <span class="comment">//backup initial step</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            <span class="keywordtype">int</span> ds_switch=0;   <span class="comment">// 0 or 1</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="keywordtype">int</span> n_step_wait=-1; <span class="comment">// number of waiting step to change ds</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            <span class="keywordtype">int</span> n_step_end=0;  <span class="comment">// number of steps integrated to reach the time end for one during the time sychronization sub steps</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            <span class="comment">// time end flag</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="keywordtype">bool</span> time_end_flag=<span class="keyword">false</span>; <span class="comment">// indicate whether time reach the end</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            <span class="comment">// step count</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> step_count=0; <span class="comment">// integration step </span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> step_count_tsyn=0; <span class="comment">// time synchronization step</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            </div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="comment">// particle data</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> n_particle = particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">/* This must suppress since after findslowdowninner, slowdown inner is reset to 1.0, recalculate ekin_sdi give completely wrong value for energy correction for slowdown change later</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">#ifdef AR_DEBUG</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">            Float ekin_check = ekin_;</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">            calcEKin();</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">            ASSERT(abs(ekin_check-ekin_)&lt;1e-10);</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">            ekin_ = ekin_check;</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">#endif</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="preprocessor">#ifdef AR_DEBUG_DUMP</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="comment">// back up initial data</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            backupIntData(backup_data_init);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      </div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            <span class="comment">// find new inner slowdown binaries, the binary tree data may be modified, thus it is safer to recheck slowdown inner binary at beginning to avoid memory issue (bin is pointer).</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <span class="keywordflow">if</span> (n_particle &gt;2) {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                <span class="keywordtype">int</span> nold = slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                findSlowDownInner(time_);</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                <span class="keywordtype">int</span> nnew = slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                <span class="comment">// in case slowdown is disabled in the next step, gt_drift_inv_ should be re-initialized</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                <span class="keywordflow">if</span> (nold&gt;0&amp;&amp;nnew==0) {</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    gt_kick_inv_ = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcAccPotAndGTKickInv(force_.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>(), epot_, particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>(), particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>(), particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>, perturber, slowdown.<a class="code" href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">getRealTime</a>());</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                    gt_drift_inv_ = gt_kick_inv_;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                }</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="keywordflow">if</span> (n_particle &gt;2) findSlowDownInner(time_);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            <span class="comment">// integration loop</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                <span class="comment">// backup data</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                <span class="keywordflow">if</span>(backup_flag) {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                    <span class="comment">// update slowdown and correct slowdown energy and gt_inv</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                    <span class="keywordflow">if</span> (!time_end_flag) updateSlowDownAndCorrectEnergy();</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                    <span class="keywordtype">int</span> bk_return_size = backupIntData(backup_data);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                    ASSERT(bk_return_size == bk_data_size);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                    (void)bk_return_size;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                }</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                <span class="keywordflow">else</span> { <span class="comment">//restore data</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                    <span class="keywordtype">int</span> bk_return_size = restoreIntData(backup_data);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                    ASSERT(bk_return_size == bk_data_size);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                    (void)bk_return_size;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                    <span class="comment">// update c.m. of binaries </span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    <span class="comment">// binary c.m. is not backup, thus recalculate to get correct c.m. velocity for position drift correction due to slowdown inner (the first drift in integrateonestep assume c.m. vel is up to date)</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    updateCenterOfMassForBinaryWithSlowDownInner();</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                <span class="comment">// get real time </span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dt_real = slowdown.<a class="code" href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">getRealTime</a>();</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                <span class="comment">// integrate one step</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                ASSERT(!isinf(ds[ds_switch]));</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                <span class="keywordflow">if</span>(n_particle==2) integrateTwoOneStep(ds[ds_switch], time_table);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                <span class="keywordflow">else</span> integrateOneStep(ds[ds_switch], time_table);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                <span class="comment">// real step size</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> time_real = slowdown.<a class="code" href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">getRealTime</a>();</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                dt_real =  time_real - dt_real;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">//                ASSERT(dt_real&gt;0.0);</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                </div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                step_count++;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                <span class="comment">// energy check</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> energy_error_bk = getEnergyErrorSlowDownInnerFromBackup(backup_data);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> etot_ref_bk = getEtotSlowDownInnerRefFromBackup(backup_data);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> energy_error = getEnergyErrorSlowDownInner();</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> energy_error_bk = getEnergyErrorFromBackup(backup_data);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> etot_ref_bk = getEtotRefFromBackup(backup_data);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> energy_error = getEnergyError();</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> energy_error_diff = energy_error - energy_error_bk;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> energy_error_rel_abs = abs(energy_error_diff/etot_ref_bk);</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                <span class="comment">// get integration error for extended Hamiltonian</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> integration_error_rel_abs = abs(energy_error_rel_abs*gt_drift_inv_);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> integration_error_rel_cum_abs = abs(energy_error*gt_drift_inv_/etot_ref_bk);</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_drift_inv = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcGTDriftInv(ekin_sdi_-etot_sdi_ref_);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> gt_drift_inv = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcGTDriftInv(ekin_-etot_ref_);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> integration_error_rel_abs = energy_error_rel_abs*gt_drift_inv;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> integration_error_rel_cum_abs = abs(energy_error*gt_drift_inv/etot_ref_bk);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                <span class="comment">// time error</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> time_diff_real_rel = (_time_end_real - time_real)/dt_real_full;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                <span class="comment">// error message print</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                <span class="keyword">auto</span> printMessage = [&amp;]() {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;  T: &quot;</span>&lt;&lt;this-&gt;time_</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  T_real: &quot;</span>&lt;&lt;time_real</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  dT_err/T: &quot;</span>&lt;&lt;time_diff_real_rel</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  ds: &quot;</span>&lt;&lt;ds[ds_switch]</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  ds(in): &quot;</span>&lt;&lt;ds_init</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  |Int_err/E|: &quot;</span>&lt;&lt;integration_error_rel_abs</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  |Int_err_cum/E|: &quot;</span>&lt;&lt;integration_error_rel_cum_abs</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  |dE/E|: &quot;</span>&lt;&lt;energy_error_rel_abs</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  dE_cum: &quot;</span>&lt;&lt;energy_error</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  Etot(SD): &quot;</span>&lt;&lt;etot_ref_bk</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  T_end: &quot;</span>&lt;&lt;time_end_flag</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  Step_count: &quot;</span>&lt;&lt;step_count</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;  Fix: &quot;</span>&lt;&lt;<span class="keyword">static_cast&lt;</span>typename std::underlying_type&lt;FixStepOption&gt;::type<span class="keyword">&gt;</span>(info.fix_step_option)</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                             &lt;&lt;std::endl;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                };</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="preprocessor">#ifdef AR_COLLECT_DS_MODIFY_INFO</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                <span class="keyword">auto</span> collectDsModifyInfo = [&amp;](<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> modify_factor) {</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                    <span class="keyword">auto</span>&amp; bin = info.getBinaryTreeRoot();</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;DsModifyInfo: &quot;</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                             &lt;&lt;ds[ds_switch]&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                             &lt;&lt;ds_init&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                             &lt;&lt;modify_factor&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                             &lt;&lt;step_count&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                             &lt;&lt;integration_error_rel_abs&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                             &lt;&lt;dt_real&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                             &lt;&lt;n_particle&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                             &lt;&lt;bin.semi&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                             &lt;&lt;bin.ecc&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                             &lt;&lt;bin.period&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                             &lt;&lt;bin.m1&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                             &lt;&lt;bin.m2&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                             &lt;&lt;bin.ecca&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                             &lt;&lt;slowdown.<a class="code" href="classAR_1_1SlowDown.html#a1f153e07b27376eb86bffb7756199b6a">getSlowDownFactorOrigin</a>()&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                             &lt;&lt;slowdown.<a class="code" href="classAR_1_1SlowDown.html#a885e6a131ed7cc37f420cc59162f4244">getPertIn</a>()&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                             &lt;&lt;slowdown.<a class="code" href="classAR_1_1SlowDown.html#af86e63ccc63510fb77c9ce495cb3a263">getPertOut</a>()&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                             &lt;&lt;std::endl;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                };</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="preprocessor">#endif </span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="preprocessor">#ifdef AR_WARN</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                <span class="comment">// warning for large number of steps</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                <span class="keywordflow">if</span>(step_count&gt;=manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a21bbe24b1e3ed94107a7532836352021">step_count_max</a>) {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                    <span class="keywordflow">if</span>(step_count%manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a21bbe24b1e3ed94107a7532836352021">step_count_max</a>==0) {</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                        std::cerr&lt;&lt;<span class="stringliteral">&quot;Warning: step count is signficiant large &quot;</span>&lt;&lt;step_count&lt;&lt;std::endl;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                        printMessage();</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                        printColumnTitle(std::cerr);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                        std::cerr&lt;&lt;std::endl;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                        printColumn(std::cerr);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                        std::cerr&lt;&lt;std::endl;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                        DATADUMP(<span class="stringliteral">&quot;dump_large_step&quot;</span>);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                    }</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;          </div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                <span class="comment">// When time sychronization steps too large, abort</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                <span class="keywordflow">if</span>(step_count_tsyn&gt;manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a21bbe24b1e3ed94107a7532836352021">step_count_max</a>) {</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Error! step count after time synchronization is too large &quot;</span>&lt;&lt;step_count_tsyn&lt;&lt;std::endl;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                    printMessage();</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    printColumnTitle(std::cerr);</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                    std::cerr&lt;&lt;std::endl;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                    printColumn(std::cerr);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                    std::cerr&lt;&lt;std::endl;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="preprocessor">#ifdef AR_DEBUG_DUMP</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">//                    restoreIntData(backup_data_init);</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                    DATADUMP(<span class="stringliteral">&quot;dump_large_step&quot;</span>);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                    abort();</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                }</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                printMessage();</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Timetable: &quot;</span>;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;cd_pair_size; i++) std::cerr&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;time_table[manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getSortCumSumCKIndex(i)];</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                std::cerr&lt;&lt;std::endl;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                <span class="comment">// modify step if energy error is large</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                <span class="keywordflow">if</span>(integration_error_rel_abs&gt;energy_error_rel_max) {</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                    <span class="keywordflow">if</span>(info.fix_step_option!=<a class="code" href="namespaceAR.html#a67c328d9c95dd7715ecd102207029196af9f90eeaf400d228facde6bc48da5cfb">FixStepOption::always</a>) {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                        <span class="comment">// energy error zero case, continue to avoid problem</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                        <span class="keywordflow">if</span> (integration_error_rel_abs==0.0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                        <span class="comment">// estimate the modification factor based on the symplectic order</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> integration_error_ratio = energy_error_rel_max/integration_error_rel_abs;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                        <span class="comment">// limit modify_factor to 0.125</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> modify_factor = std::max(manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.calcStepModifyFactorFromErrorRatio(integration_error_ratio), <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(0.125));</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                        ASSERT(modify_factor&gt;0.0);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                        <span class="comment">// for initial steps</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                        <span class="keywordflow">if</span>(step_count&lt;3) {</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                            n_step_wait=-1;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                            ds[ds_switch] *= modify_factor;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                            ds[1-ds_switch] = ds[ds_switch];</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                            info.ds = ds[ds_switch];</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                            ASSERT(!isinf(ds[ds_switch]));</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                            backup_flag = <span class="keyword">false</span>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="preprocessor">#ifdef AR_COLLECT_DS_MODIFY_INFO</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                            collectDsModifyInfo(modify_factor);</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Detected energy error too large, integration_error/energy_error_max =&quot;</span>&lt;&lt;1.0/integration_error_ratio&lt;&lt;<span class="stringliteral">&quot; integration_error_rel_abs =&quot;</span>&lt;&lt;integration_error_rel_abs&lt;&lt;<span class="stringliteral">&quot; modify_factor =&quot;</span>&lt;&lt;modify_factor&lt;&lt;std::endl;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                        }</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                        <span class="comment">// for big energy error</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info.fix_step_option==<a class="code" href="namespaceAR.html#a67c328d9c95dd7715ecd102207029196a334c4a4c42fdb79d7ebc3e73b517e6f8">FixStepOption::none</a> &amp;&amp; integration_error_ratio&lt;0.1) {</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                            <span class="keywordflow">if</span>(backup_flag) ds_backup = ds[ds_switch];</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                            ds[ds_switch] *= modify_factor;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                            ds[1-ds_switch] = ds[ds_switch];</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                            ASSERT(!isinf(ds[ds_switch]));</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                            backup_flag = <span class="keyword">false</span>;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                            n_step_wait = 2*<a class="code" href="Float_8h.html#aa0a42312a91949f0a96dd9fb22add592">to_int</a>(1.0/modify_factor);</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Detected energy error too large, integration_error/energy_error_max =&quot;</span>&lt;&lt;1.0/integration_error_ratio&lt;&lt;<span class="stringliteral">&quot; integration_error_rel_abs =&quot;</span>&lt;&lt;integration_error_rel_abs&lt;&lt;<span class="stringliteral">&quot; modify_factor =&quot;</span>&lt;&lt;modify_factor&lt;&lt;<span class="stringliteral">&quot; n_step_wait =&quot;</span>&lt;&lt;n_step_wait&lt;&lt;std::endl;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                        }</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                    }</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                }</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">// too much output</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">//#ifdef AR_WARN</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">//                if(integration_error_rel_abs&gt;100.0*energy_error_rel_max) {</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment">//                    std::cerr&lt;&lt;&quot;Warning: symplectic integrator error &gt; 100*criterion:&quot;&lt;&lt;integration_error_rel_abs&lt;&lt;std::endl;</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">//#endif</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                <span class="comment">// abort when too small step found</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                <span class="keywordflow">if</span>(!time_end_flag&amp;&amp;dt_real&lt;dt_real_min) {</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                    <span class="comment">// for initial steps</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                    <span class="keywordflow">if</span>(step_count&lt;3 &amp;&amp; dt_real&lt;0) {</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                        n_step_wait=-1;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                        <span class="comment">// limit modify_factor to 0.125</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> modify_factor = std::min(std::max(manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.calcStepModifyFactorFromErrorRatio(abs(_time_end_real/dt_real)), <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(0.0625)),<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(0.5)); </div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                        ds[ds_switch] *= modify_factor;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                        ds[1-ds_switch] = ds[ds_switch];</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                        info.ds = ds[ds_switch];</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                        ASSERT(!isinf(ds[ds_switch]));</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                        backup_flag = <span class="keyword">false</span>;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="preprocessor">#ifdef AR_COLLECT_DS_MODIFY_INFO</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                        collectDsModifyInfo(modify_factor);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                        std::cerr&lt;&lt;<span class="stringliteral">&quot;Detected negative time at beginning dt_real=&quot;</span>&lt;&lt;dt_real&lt;&lt;<span class="stringliteral">&quot; stepcount=&quot;</span>&lt;&lt;step_count&lt;&lt;std::endl;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                    }</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Error! symplectic integrated time step (&quot;</span>&lt;&lt;dt_real&lt;&lt;<span class="stringliteral">&quot;) &lt; minimum step (&quot;</span>&lt;&lt;dt_real_min&lt;&lt;<span class="stringliteral">&quot;)!\n&quot;</span>;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                    printMessage();</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="preprocessor">#ifdef AR_DEBUG_DUMP</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                    DATADUMP(<span class="stringliteral">&quot;dump_negative_time&quot;</span>);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                    abort();</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                <span class="comment">// check integration time</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                <span class="keywordflow">if</span>(time_real &lt; _time_end_real - time_error_real){</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                    <span class="comment">// check interrupt condiction</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                    <span class="keywordflow">if</span> (manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a3c37e4d27a9a2828975d5c04175fc149">interrupt_detection_option</a>==1) {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                        <a class="code" href="classCOMM_1_1BinaryTree.html">COMM::BinaryTree&lt;Tparticle&gt;</a>* bin_interrupt = NULL;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                        <span class="keyword">auto</span>&amp; bin_root = info.getBinaryTreeRoot();</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                        bin_interrupt = bin_root.<a class="code" href="classCOMM_1_1BinaryTree.html#a7f522c71405aed42888caaf4f8eb45eb">processRootIter</a>(bin_interrupt, Tmethod::checkInterruptIter);</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                        <span class="keywordflow">if</span> (bin_interrupt!=NULL) {</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                            <span class="comment">// cumulative step count </span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                            profile.<a class="code" href="classAR_1_1Profile.html#a0279e942777d4e76588cd8cca5ffba36">step_count</a> = step_count;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                            profile.<a class="code" href="classAR_1_1Profile.html#ae30eb312e2c4399bdfd0b4c76b03e2d9">step_count_tsyn</a> = step_count_tsyn;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                            profile.<a class="code" href="classAR_1_1Profile.html#a54a781c377e38381f311fba9a257340a">step_count_sum</a> += step_count;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                            profile.<a class="code" href="classAR_1_1Profile.html#ad6328050e002bd13b2848706ceb76bb2">step_count_tsyn_sum</a> += step_count_tsyn;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                            <span class="keywordflow">return</span> bin_interrupt;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                        }</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                    }</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                    <span class="comment">// step increase depend on n_step_wait or energy_error</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                    <span class="keywordflow">if</span>(info.fix_step_option==<a class="code" href="namespaceAR.html#a67c328d9c95dd7715ecd102207029196a334c4a4c42fdb79d7ebc3e73b517e6f8">FixStepOption::none</a> &amp;&amp; !time_end_flag) {</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                        <span class="comment">// waiting step count reach</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                        <span class="keywordflow">if</span>(n_step_wait==0) {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Recover to backup step ds_current=&quot;</span>&lt;&lt;ds[ds_switch]&lt;&lt;<span class="stringliteral">&quot; ds_next=&quot;</span>&lt;&lt;ds[1-ds_switch]&lt;&lt;<span class="stringliteral">&quot; ds_backup=&quot;</span>&lt;&lt;ds_backup&lt;&lt;std::endl;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                            ds[1-ds_switch] = ds_backup;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                            ASSERT(!isinf(ds[1-ds_switch]));</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                        }</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                        <span class="comment">// increase step size if energy error is small</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(integration_error_rel_abs&lt;energy_error_rel_max_half_step&amp;&amp;integration_error_rel_abs&gt;0.0) {</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> integration_error_ratio = energy_error_rel_max/integration_error_rel_abs;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> modify_factor = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.calcStepModifyFactorFromErrorRatio(integration_error_ratio);</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                            ASSERT(modify_factor&gt;0.0);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                            ds[1-ds_switch] *= modify_factor;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                            info.ds = ds[1-ds_switch];</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                            ASSERT(!isinf(ds[1-ds_switch]));</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Energy error is small enought for increase step, integration_error_rel_abs=&quot;</span>&lt;&lt;integration_error_rel_abs</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                                     &lt;&lt;<span class="stringliteral">&quot; energy_error_rel_max=&quot;</span>&lt;&lt;energy_error_rel_max&lt;&lt;<span class="stringliteral">&quot; step_modify_factor=&quot;</span>&lt;&lt;modify_factor&lt;&lt;<span class="stringliteral">&quot; new ds=&quot;</span>&lt;&lt;ds[1-ds_switch]&lt;&lt;std::endl;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                        }</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                        n_step_wait--;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                    }</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                    <span class="comment">// time sychronization on case, when step size too small to reach time end, increase step size</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                    <span class="keywordflow">if</span>(time_end_flag &amp;&amp; ds[ds_switch]==ds[1-ds_switch]) {</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                        step_count_tsyn++;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dt_real_end = _time_end_real - time_real;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                        <span class="keywordflow">if</span>(n_step_end&gt;1 &amp;&amp; dt_real&lt;0.3*dt_real_end) {</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                            <span class="comment">// dt_real should be &gt;0.0</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                            <span class="comment">// ASSERT(dt_real&gt;0.0);</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                            ds[1-ds_switch] = ds[ds_switch] * dt_real_end/abs(dt_real);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                            ASSERT(!isinf(ds[1-ds_switch]));</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Time step dt(real) &quot;</span>&lt;&lt;dt_real&lt;&lt;<span class="stringliteral">&quot; &lt;0.3*(time_end-time)(real) &quot;</span>&lt;&lt;dt_real_end&lt;&lt;<span class="stringliteral">&quot; enlarge step factor: &quot;</span>&lt;&lt;dt_real_end/dt_real&lt;&lt;<span class="stringliteral">&quot; new ds: &quot;</span>&lt;&lt;ds[1-ds_switch]&lt;&lt;std::endl;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                        }</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                        <span class="keywordflow">else</span> n_step_end++;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                    }</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                    <span class="comment">// when used once, update to the new step</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                    ds[ds_switch] = ds[1-ds_switch]; </div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                    ASSERT(!isinf(ds[ds_switch]));</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                    ds_switch = 1-ds_switch;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                    backup_flag = <span class="keyword">true</span>;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                }</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(time_real &gt; _time_end_real + time_error_real) {</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                    time_end_flag = <span class="keyword">true</span>;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                    backup_flag = <span class="keyword">false</span>;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                    step_count_tsyn++;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                    n_step_end=0;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                    <span class="comment">// check timetable</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                    <span class="keywordtype">int</span> i=-1,k=0; <span class="comment">// i indicate the increasing time index, k is the corresponding index in time_table</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                    <span class="keywordflow">for</span>(i=0; i&lt;cd_pair_size; i++) {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                        k = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getSortCumSumCKIndex(i);</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                        <span class="keywordflow">if</span>(_time_end_real&lt;time_table[k]) <span class="keywordflow">break</span>;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                    }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                    <span class="keywordflow">if</span> (i==0) { <span class="comment">// first step case</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                        ASSERT(time_table[k]&gt;0.0);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                        ds[ds_switch] *= manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getSortCumSumCK(i)*_time_end_real/time_table[k];</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                        ds[1-ds_switch] = ds[ds_switch];</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                        ASSERT(!isinf(ds[ds_switch]));</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                        std::cerr&lt;&lt;<span class="stringliteral">&quot;Time_end_real reach, time[k](real)= &quot;</span>&lt;&lt;time_table[k]&lt;&lt;<span class="stringliteral">&quot; time(real)= &quot;</span>&lt;&lt;time_real&lt;&lt;<span class="stringliteral">&quot; time_end/time[k](real)=&quot;</span>&lt;&lt;_time_end_real/time_table[k]&lt;&lt;<span class="stringliteral">&quot; CumSum_CK=&quot;</span>&lt;&lt;manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getSortCumSumCK(i)&lt;&lt;<span class="stringliteral">&quot; ds(next) = &quot;</span>&lt;&lt;ds[ds_switch]&lt;&lt;<span class="stringliteral">&quot; ds(next_next) = &quot;</span>&lt;&lt;ds[1-ds_switch]&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                    }</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                    <span class="keywordflow">else</span> { <span class="comment">// not first step case, get the interval time </span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                        <span class="comment">// previous integrated sub time in time table</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> time_real_prev = time_table[manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getSortCumSumCKIndex(i-1)];</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> dt_real_k = time_table[k] - time_real_prev;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> ds_tmp = ds[ds_switch];</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                        <span class="comment">// get cumsum CK factor for two steps near the time_end_real</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> cck_prev = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getSortCumSumCK(i-1);</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> cck = manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">step</a>.getSortCumSumCK(i);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                        <span class="comment">// in case the time is between two sub step, first scale the next step with the previous step CumSum CK cck(i-1)</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                        ASSERT(!isinf(cck_prev));</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                        ds[ds_switch] *= cck_prev;  </div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                        ASSERT(!isinf(ds[ds_switch]));</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                        <span class="comment">// then next next step, scale with the CumSum CK between two step: cck(i) - cck(i-1) </span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                        ASSERT(dt_real_k&gt;0.0);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                        ds[1-ds_switch] = ds_tmp*(cck-cck_prev)*std::min(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>(1.0),(_time_end_real-time_real_prev+time_error_real)/dt_real_k); </div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                        ASSERT(!isinf(ds[1-ds_switch]));</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                        std::cerr&lt;&lt;<span class="stringliteral">&quot;Time_end_real reach, time_prev(real)= &quot;</span>&lt;&lt;time_real_prev&lt;&lt;<span class="stringliteral">&quot; time[k](real)= &quot;</span>&lt;&lt;time_table[k]&lt;&lt;<span class="stringliteral">&quot; time(real)= &quot;</span>&lt;&lt;time_real&lt;&lt;<span class="stringliteral">&quot; (time_end-time_prev)/dt(real)=&quot;</span>&lt;&lt;(_time_end_real-time_real_prev)/dt_real&lt;&lt;<span class="stringliteral">&quot; CumSum_CK=&quot;</span>&lt;&lt;cck&lt;&lt;<span class="stringliteral">&quot; CumSum_CK(prev)=&quot;</span>&lt;&lt;cck_prev&lt;&lt;<span class="stringliteral">&quot; ds(next) = &quot;</span>&lt;&lt;ds[ds_switch]&lt;&lt;<span class="stringliteral">&quot; ds(next_next) = &quot;</span>&lt;&lt;ds[1-ds_switch]&lt;&lt;<span class="stringliteral">&quot; \n&quot;</span>;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                    }</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                }</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="preprocessor">#ifdef AR_DEEP_DEBUG</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Finish, time_diff_real_rel = &quot;</span>&lt;&lt;time_diff_real_rel&lt;&lt;<span class="stringliteral">&quot; integration_error_rel_abs = &quot;</span>&lt;&lt;integration_error_rel_abs&lt;&lt;std::endl;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">//#ifdef AR_WARN</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">//                    if (integration_error_rel_cum_abs&gt;energy_error_rel_max) {</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">//                        std::cerr&lt;&lt;&quot;AR large energy error at the end! &quot;;</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">//                        printMessage();</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">//#ifdef AR_DEBUG_DUMP</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment"></span><span class="comment">//                        DATADUMP(&quot;dump_large_error&quot;);</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">//#endif</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">//                    }</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">//#endif</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                }</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            }</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            <span class="comment">// cumulative step count </span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            profile.<a class="code" href="classAR_1_1Profile.html#a0279e942777d4e76588cd8cca5ffba36">step_count</a> = step_count;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            profile.<a class="code" href="classAR_1_1Profile.html#ae30eb312e2c4399bdfd0b4c76b03e2d9">step_count_tsyn</a> = step_count_tsyn;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            profile.<a class="code" href="classAR_1_1Profile.html#a54a781c377e38381f311fba9a257340a">step_count_sum</a> += step_count;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            profile.<a class="code" href="classAR_1_1Profile.html#ad6328050e002bd13b2848706ceb76bb2">step_count_tsyn_sum</a> += step_count_tsyn;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        }</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ad9d82c4c1565d944c64a1a48961980e6"> 1540</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ad9d82c4c1565d944c64a1a48961980e6">correctCenterOfMassDrift</a>() {</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            ASSERT(!particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a04903afdcfee09b36b30600a2683c99e">isOriginFrame</a>());</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> mcm=0.0, pos_cm[3]={0.0,0.0,0.0}, vel_cm[3]={0.0,0.0,0.0};</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keyword">auto</span>* particle_data= particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>(); i++) {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> *ri = particle_data[i].pos;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> *vi = particle_data[i].getVel();</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> mi  = particle_data[i].mass;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                pos_cm[0] += ri[0] * mi;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                pos_cm[1] += ri[1] * mi;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                pos_cm[2] += ri[2] * mi;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                vel_cm[0] += vi[0] * mi;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                vel_cm[1] += vi[1] * mi;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                vel_cm[2] += vi[2] * mi;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                mcm += mi;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            }</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            pos_cm[0] /= mcm; </div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            pos_cm[1] /= mcm; </div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            pos_cm[2] /= mcm; </div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            vel_cm[0] /= mcm; </div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            vel_cm[1] /= mcm; </div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            vel_cm[2] /= mcm;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>(); i++) {</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> *ri = particle_data[i].pos;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> *vi = particle_data[i].getVel();</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                ri[0] -= pos_cm[0]; </div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                ri[1] -= pos_cm[1]; </div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                ri[2] -= pos_cm[2]; </div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                vi[0] -= vel_cm[0]; </div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                vi[1] -= vel_cm[1]; </div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                vi[2] -= vel_cm[2]; </div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            }</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        }</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> Tptcl&gt;</div><div class="line"><a name="l01583"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ad24173534adac2b1e58a40de5e525baf"> 1583</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ad24173534adac2b1e58a40de5e525baf">writeBackSlowDownParticles</a>(<span class="keyword">const</span> Tptcl&amp; _particle_cm) {</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            ASSERT(particles.<a class="code" href="classCOMM_1_1List.html#a53cc90f6633ba9fed844442fc5b36b47">getMode</a>()==<a class="code" href="namespaceCOMM.html#aa0ca1c24dcb00331c6dca89a0a188fe3a12cba3ee81cf4a793796a51b6327c678">COMM::ListMode::copy</a>);</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            ASSERT(!particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a04903afdcfee09b36b30600a2683c99e">isOriginFrame</a>());</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            <span class="keyword">auto</span>* particle_adr = particles.<a class="code" href="classCOMM_1_1List.html#a432ae1abc33765666f627149c0982c3a">getOriginAddressArray</a>();</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            <span class="keyword">auto</span>* particle_data= particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            <span class="keyword">const</span> <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> kappa_inv = 1.0/slowdown.<a class="code" href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">getSlowDownFactor</a>();</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>(); i++) {</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                ASSERT(particle_adr[i]-&gt;mass == particle_data[i].mass);</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                particle_adr[i]-&gt;mass = particle_data[i].mass;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                particle_adr[i]-&gt;pos[0] = particle_data[i].pos[0] + _particle_cm.pos[0];</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                particle_adr[i]-&gt;pos[1] = particle_data[i].pos[1] + _particle_cm.pos[1];</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                particle_adr[i]-&gt;pos[2] = particle_data[i].pos[2] + _particle_cm.pos[2];</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                particle_adr[i]-&gt;vel[0] = particle_data[i].vel[0]*kappa_inv + _particle_cm.vel[0];</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                particle_adr[i]-&gt;vel[1] = particle_data[i].vel[1]*kappa_inv + _particle_cm.vel[1];</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                particle_adr[i]-&gt;vel[2] = particle_data[i].vel[2]*kappa_inv + _particle_cm.vel[2];</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            }</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        }</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <span class="keyword">template</span> &lt;<span class="keyword">class</span> Tptcl&gt;</div><div class="line"><a name="l01607"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a0f18041128f371f6c76d87b2684499cb"> 1607</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a0f18041128f371f6c76d87b2684499cb">writeBackParticlesOriginFrame</a>() {</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            ASSERT(particles.<a class="code" href="classCOMM_1_1List.html#a53cc90f6633ba9fed844442fc5b36b47">getMode</a>()==<a class="code" href="namespaceCOMM.html#aa0ca1c24dcb00331c6dca89a0a188fe3a12cba3ee81cf4a793796a51b6327c678">COMM::ListMode::copy</a>);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <span class="keyword">auto</span>* particle_adr = particles.<a class="code" href="classCOMM_1_1List.html#a432ae1abc33765666f627149c0982c3a">getOriginAddressArray</a>();</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            <span class="keyword">auto</span>* particle_data= particles.<a class="code" href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">getDataAddress</a>();</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            <span class="keywordflow">if</span> (particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a04903afdcfee09b36b30600a2683c99e">isOriginFrame</a>()) {</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>(); i++) {</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                    *(Tptcl*)particle_adr[i] = particle_data[i];</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                }</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;particles.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>(); i++) {</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                    Tptcl pc = particle_data[i];</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                    pc.pos[0] = particle_data[i].pos[0] + particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>.pos[0];</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                    pc.pos[1] = particle_data[i].pos[1] + particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>.pos[1];</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                    pc.pos[2] = particle_data[i].pos[2] + particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>.pos[2];</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                    pc.vel[0] = particle_data[i].vel[0] + particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>.vel[0];</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                    pc.vel[1] = particle_data[i].vel[1] + particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>.vel[1];</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                    pc.vel[2] = particle_data[i].vel[2] + particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">cm</a>.vel[2];</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                    </div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                    *(Tptcl*)particle_adr[i] = pc;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                }</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            }</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        }</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01636"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a45a6ec5453cd66ed15af6d0612d6d1a8"> 1636</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a45a6ec5453cd66ed15af6d0612d6d1a8">getTime</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            <span class="keywordflow">return</span> slowdown.<a class="code" href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">getRealTime</a>();</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        }</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a28a6f4109a57453619d93b144943101d"> 1643</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a28a6f4109a57453619d93b144943101d">getEkin</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            <span class="keywordflow">return</span> ekin_;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        }</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01650"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a9abc72ad076344e049c5b2505858316b"> 1650</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a9abc72ad076344e049c5b2505858316b">getEpot</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;            <span class="keywordflow">return</span> epot_;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        }</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div><div class="line"><a name="l01657"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a01f24202c09aecd0285a8b5e168379b1"> 1657</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a01f24202c09aecd0285a8b5e168379b1">getEtotRef</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            <span class="keywordflow">return</span> etot_ref_;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        }</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a83cfa161c5ccb66793e9455fef99da92"> 1664</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a83cfa161c5ccb66793e9455fef99da92">getEtot</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="keywordflow">return</span> ekin_ + epot_;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        }</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a6cd74146fe2723d5680ae47d38869237"> 1671</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a6cd74146fe2723d5680ae47d38869237">getEnergyError</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            <span class="keywordflow">return</span> ekin_ + epot_ - etot_ref_;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        }</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01676"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#afc4f679dc3bd99fa80e4b29677bc64f3"> 1676</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#afc4f679dc3bd99fa80e4b29677bc64f3">getEnergyErrorFromBackup</a>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* _bk)<span class="keyword"> const </span>{</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;            <span class="keywordflow">return</span> -_bk[1] + _bk[2] + _bk[3];</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        }</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div><div class="line"><a name="l01681"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a0db82b51fb13faabb3350b5f97f6cfae"> 1681</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a0db82b51fb13faabb3350b5f97f6cfae">getEtotRefFromBackup</a>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* _bk)<span class="keyword"> const </span>{</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            <span class="keywordflow">return</span> _bk[1];</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        }</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div><div class="line"><a name="l01686"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ae891a55d0873158a3e0839c7869bb078"> 1686</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ae891a55d0873158a3e0839c7869bb078">getEtotFromBackup</a>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* _bk)<span class="keyword"> const </span>{</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;            <span class="keywordflow">return</span> _bk[2] + _bk[3];</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        }</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div><div class="line"><a name="l01691"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5a5a148b048d869e46e8eb015f44eaef"> 1691</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5a5a148b048d869e46e8eb015f44eaef">resetDESlowDownChangeCum</a>() {</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            de_sd_change_cum_ = 0.0;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            dH_sd_change_cum_ = 0.0;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        }</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div><div class="line"><a name="l01697"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a38d0b2d128d6356c1e35ee574ae13c53"> 1697</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a38d0b2d128d6356c1e35ee574ae13c53">getDESlowDownChangeCum</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;            <span class="keywordflow">return</span> de_sd_change_cum_;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        }</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div><div class="line"><a name="l01702"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a73cfdef4d77dc9a3ea3b673cfde775de"> 1702</a></span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a73cfdef4d77dc9a3ea3b673cfde775de">getDHSlowDownChangeCum</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            <span class="keywordflow">return</span> dH_sd_change_cum_;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        }</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> getEkinSlowDownInner()<span class="keyword"> const </span>{</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            <span class="keywordflow">return</span> ekin_sdi_;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        }</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> getEpotSlowDownInner()<span class="keyword"> const </span>{</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            <span class="keywordflow">return</span> epot_sdi_;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        }</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> getEtotSlowDownInnerRef()<span class="keyword"> const </span>{</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            <span class="keywordflow">return</span> etot_sdi_ref_;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        }</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> getEtotSlowDownInner()<span class="keyword"> const </span>{</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <span class="keywordflow">return</span> ekin_sdi_ + epot_sdi_;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        }</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> getEnergyErrorSlowDownInner()<span class="keyword"> const </span>{</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            <span class="keywordflow">return</span> ekin_sdi_ + epot_sdi_ - etot_sdi_ref_;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        }</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> getEnergyErrorSlowDownInnerFromBackup(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* _bk)<span class="keyword"> const </span>{</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            <span class="keywordflow">return</span> -_bk[6] + _bk[7] + _bk[8];</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        }</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> getEtotSlowDownInnerRefFromBackup(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* _bk)<span class="keyword"> const </span>{</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            <span class="keywordflow">return</span> _bk[6];</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        }</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> getEtotSlowDownInnerFromBackup(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* _bk)<span class="keyword"> const </span>{</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            <span class="keywordflow">return</span> _bk[7] + _bk[8];</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        }</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ab16cecae3e9445901dd72cdc0e1d5115"> 1761</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ab16cecae3e9445901dd72cdc0e1d5115">getBackupDataSize</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            <span class="keywordtype">int</span> bk_size = 6;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            bk_size += 3; </div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            bk_size += 2;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            bk_size += particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a1f2bf3c79eca0f4eaa338c3191b92d2c">getBackupDataSize</a>();</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            bk_size += slowdown.<a class="code" href="classAR_1_1SlowDown.html#aa4a3ca60109ddaf0124d34109f18ddb9">getBackupDataSize</a>();</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            <span class="keywordflow">return</span> bk_size;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        }</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01779"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5fc16fdc3e8d304c33e6a2d22dfd1e52"> 1779</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5fc16fdc3e8d304c33e6a2d22dfd1e52">backupIntData</a>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* _bk) {</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            <span class="keywordtype">int</span> bk_size=0;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            _bk[bk_size++] = time_;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            _bk[bk_size++] = etot_ref_;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            _bk[bk_size++] = ekin_;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            _bk[bk_size++] = epot_;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            _bk[bk_size++] = de_sd_change_cum_;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            _bk[bk_size++] = dH_sd_change_cum_;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            _bk[bk_size++] = etot_sdi_ref_;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            _bk[bk_size++] = ekin_sdi_;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            _bk[bk_size++] = epot_sdi_;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            _bk[bk_size++] = gt_drift_inv_;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            _bk[bk_size++] = gt_kick_inv_;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            bk_size += particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#ae28ed1ffac4d21b920fdec8b32d1215c">backupParticlePosVel</a>(&amp;_bk[bk_size]); </div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            bk_size += slowdown.<a class="code" href="classAR_1_1SlowDown.html#a6103fa59192c6de25dd9be66e76d0189">backupSlowDownFactorAndTimeReal</a>(&amp;_bk[bk_size]); <span class="comment">// time_real, slowdownfactor</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            <span class="keywordflow">return</span> bk_size;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        }</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div><div class="line"><a name="l01808"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aefc316aac9438bf9bf6e84aed6c7a952"> 1808</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aefc316aac9438bf9bf6e84aed6c7a952">restoreIntData</a>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>* _bk) {</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="keywordtype">int</span> bk_size = 0;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            time_     = _bk[bk_size++];</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            etot_ref_ = _bk[bk_size++];</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            ekin_     = _bk[bk_size++];</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            epot_     = _bk[bk_size++];</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            de_sd_change_cum_= _bk[bk_size++];</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            dH_sd_change_cum_= _bk[bk_size++];</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            etot_sdi_ref_ = _bk[bk_size++];</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            ekin_sdi_     = _bk[bk_size++];</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            epot_sdi_     = _bk[bk_size++];</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            gt_drift_inv_  = _bk[bk_size++];</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            gt_kick_inv_   = _bk[bk_size++];</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            bk_size += particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#aa7e0c949d709205186148cab38e5cd96">restoreParticlePosVel</a>(&amp;_bk[bk_size]);</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            bk_size += slowdown.<a class="code" href="classAR_1_1SlowDown.html#a9a08a4212d82104f92a7b870f5d523fb">restoreSlowDownFactorAndTimeReal</a>(&amp;_bk[bk_size]);</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            <span class="keywordflow">return</span> bk_size;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        }</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a> getGTDriftInv()<span class="keyword"> const </span>{</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            <span class="keywordflow">return</span> gt_drift_inv_;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        }</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01848"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a810d3b067eb342d28e6f97c7041b96c0"> 1848</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a810d3b067eb342d28e6f97c7041b96c0">printColumnTitle</a>(std::ostream &amp; _fout, <span class="keyword">const</span> <span class="keywordtype">int</span> _width=20, <span class="keyword">const</span> <span class="keywordtype">int</span> _n_sd=0) {</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;Time_int&quot;</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;dE&quot;</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;Etot&quot;</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;Ekin&quot;</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;Epot&quot;</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;Gt_drift&quot;</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;H&quot;</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;dE_SDC_cum&quot;</span> </div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;dH_SDC_cum&quot;</span>; </div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;dE_SD_in&quot;</span> </div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;Etot_SD_in&quot;</span> </div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;Ekin_SD_in&quot;</span> </div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;Epot_SD_in&quot;</span>;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;N_SD_in&quot;</span>;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;_n_sd; i++) {</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                _fout&lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;I1&quot;</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                     &lt;&lt;std::setw(_width)&lt;&lt;<span class="stringliteral">&quot;I2&quot;</span>;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                slowdown.<a class="code" href="classAR_1_1SlowDown.html#aa871b6ffb269568fa6108c547234f09f">printColumnTitle</a>(_fout, _width);</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;            }</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;            slowdown.<a class="code" href="classAR_1_1SlowDown.html#aa871b6ffb269568fa6108c547234f09f">printColumnTitle</a>(_fout, _width);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            perturber.printColumnTitle(_fout, _width);</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            info.printColumnTitle(_fout, _width);</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            profile.<a class="code" href="classAR_1_1Profile.html#a1b5aebbb911d06727642ccf97eca9c31">printColumnTitle</a>(_fout, _width);</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a2d92a2c26818cf9820ea13026091fb81">printColumnTitle</a>(_fout, _width);</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        }</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;</div><div class="line"><a name="l01884"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a73d3b8fc6bae672f8f935a8c44545730"> 1884</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a73d3b8fc6bae672f8f935a8c44545730">printColumn</a>(std::ostream &amp; _fout, <span class="keyword">const</span> <span class="keywordtype">int</span> _width=20, <span class="keyword">const</span> <span class="keywordtype">int</span> _n_sd=0){</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;time_</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;getEnergyError()</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;etot_ref_</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;ekin_</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;epot_;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;1.0/gt_drift_inv_</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;etot_ref_/gt_drift_inv_;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;1.0/manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcGTDriftInv(ekin_sdi_-etot_sdi_ref_)</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcH(ekin_sdi_-etot_sdi_ref_, epot_sdi_);</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;1.0/manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcGTDriftInv(ekin_-etot_ref_)</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;manager-&gt;<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">interaction</a>.calcH(ekin_-etot_ref_, epot_);</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;de_sd_change_cum_</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;dH_sd_change_cum_;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor">#ifdef AR_SLOWDOWN_INNER</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;getEnergyErrorSlowDownInner()</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;etot_sdi_ref_ </div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;ekin_sdi_ </div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                 &lt;&lt;std::setw(_width)&lt;&lt;epot_sdi_;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;            _fout&lt;&lt;std::setw(_width)&lt;&lt;slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            <span class="keywordtype">int</span> n_sd_now = slowdown_inner.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;            <a class="code" href="classAR_1_1SlowDown.html">SlowDown</a> sd_empty;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;_n_sd; i++) {</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                <span class="keywordflow">if</span> (i&lt;n_sd_now) {</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                    _fout&lt;&lt;std::setw(_width)&lt;&lt;slowdown_inner[i].bin-&gt;getMemberIndex(0)</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                         &lt;&lt;std::setw(_width)&lt;&lt;slowdown_inner[i].bin-&gt;getMemberIndex(1);</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                    slowdown_inner[i].slowdown.printColumn(_fout, _width);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                }</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                    _fout&lt;&lt;std::setw(_width)&lt;&lt;-1</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                         &lt;&lt;std::setw(_width)&lt;&lt;-1;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                    sd_empty.<a class="code" href="classAR_1_1SlowDown.html#aad85683de34ff2da23215cf26ff94f9b">printColumn</a>(_fout, _width);</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                }</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            }</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;            slowdown.<a class="code" href="classAR_1_1SlowDown.html#aad85683de34ff2da23215cf26ff94f9b">printColumn</a>(_fout, _width);</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            perturber.printColumn(_fout, _width);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;            info.printColumn(_fout, _width);</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;            profile.<a class="code" href="classAR_1_1Profile.html#a40692f5fa715489d67346f2a3942f1b4">printColumn</a>(_fout, _width);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;            particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a785c959cd78824f9b7801a6529f96ac6">printColumn</a>(_fout, _width);</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        }</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div><div class="line"><a name="l01935"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a72cd3195cd03b8e4b516e8b574e6defb"> 1935</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a72cd3195cd03b8e4b516e8b574e6defb">writeBinary</a>(FILE *_fout) {</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            fwrite(&amp;time_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fout);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;            fwrite(&amp;etot_ref_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fout);</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            fwrite(&amp;ekin_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fout);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            fwrite(&amp;epot_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fout);</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            fwrite(&amp;gt_drift_inv_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fout);</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            <span class="keywordtype">int</span> size = force_.<a class="code" href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">getSize</a>();</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;            fwrite(&amp;size, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), 1, _fout);</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;size; i++) force_[i].<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#ab360e8472572d3df9e5dcc5dcfa2a548">writeBinary</a>(_fout);</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            </div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#a9841046fae8fbbd01ddfa4c549aaa23d">writeBinary</a>(_fout);</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            slowdown.<a class="code" href="classAR_1_1SlowDown.html#a3ba67fc16c6ca3c9e240350c43a52fd2">writeBinary</a>(_fout);</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;            perturber.writeBinary(_fout);</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;            info.writeBinary(_fout);</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;            profile.<a class="code" href="classAR_1_1Profile.html#ae3afe50f02c55bb640ec60569d9a359a">writeBinary</a>(_fout);</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        }</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div><div class="line"><a name="l01957"></a><span class="lineno"><a class="line" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a9a5c7bd3dfff2fd3ab96fd639ec30d27"> 1957</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a9a5c7bd3dfff2fd3ab96fd639ec30d27">readBinary</a>(FILE *_fin) {</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            <span class="keywordtype">size_t</span> rcount = fread(&amp;time_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fin);</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            rcount += fread(&amp;etot_ref_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fin);</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;            rcount += fread(&amp;ekin_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fin);</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            rcount += fread(&amp;epot_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fin);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <span class="keywordflow">if</span> (rcount&lt;4) {</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: Data reading fails! requiring data number is 4, only obtain &quot;</span>&lt;&lt;rcount&lt;&lt;<span class="stringliteral">&quot;.\n&quot;</span>;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                abort();</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;            }</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="preprocessor">#ifdef AR_TTL</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            rcount = fread(&amp;gt_drift_inv_, <span class="keyword">sizeof</span>(<a class="code" href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a>), 1, _fin);</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;            <span class="keywordflow">if</span> (rcount&lt;1) {</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: Data reading fails! requiring data number is 1, only obtain &quot;</span>&lt;&lt;rcount&lt;&lt;<span class="stringliteral">&quot;.\n&quot;</span>;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                abort();</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            }</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;            <span class="keywordtype">int</span> size;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            rcount = fread(&amp;size, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1, _fin);</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            <span class="keywordflow">if</span>(rcount&lt;1) {</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: Data reading fails! requiring data number is 1, only obtain &quot;</span>&lt;&lt;rcount&lt;&lt;<span class="stringliteral">&quot;.\n&quot;</span>;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                abort();</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            }</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            <span class="keywordflow">if</span>(size&lt;0) {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: array size &lt;0 &quot;</span>&lt;&lt;size&lt;&lt;<span class="stringliteral">&quot;&lt;=0!\n&quot;</span>;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                abort();</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            }</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            <span class="keywordflow">if</span> (size&gt;0) {</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                force_.<a class="code" href="classCOMM_1_1List.html#a10c70f9a45d06c2589898cbaf1e4fbf8">setMode</a>(<a class="code" href="namespaceCOMM.html#aa0ca1c24dcb00331c6dca89a0a188fe3af5ddaf0ca7929578b408c909429f68f2">COMM::ListMode::local</a>);</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                force_.<a class="code" href="classCOMM_1_1List.html#a7f125554959409d40217deb7402c0de9">reserveMem</a>(size);</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                force_.<a class="code" href="classCOMM_1_1List.html#a0f3dd09ceff0ce9b3ffd15f48a9ea9c4">resizeNoInitialize</a>(size);</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;size; i++) force_[i].<a class="code" href="classAR_1_1TimeTransformedSymplecticManager.html#a468331841b3d06894c4fb450891c7c2e">readBinary</a>(_fin);</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            }</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            </div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            particles.<a class="code" href="classCOMM_1_1List.html#a10c70f9a45d06c2589898cbaf1e4fbf8">setMode</a>(<a class="code" href="namespaceCOMM.html#aa0ca1c24dcb00331c6dca89a0a188fe3af5ddaf0ca7929578b408c909429f68f2">COMM::ListMode::local</a>);</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            particles.<a class="code" href="classCOMM_1_1ParticleGroup.html#ac437d74b8165f0ada466e1bedca66a58">readBinary</a>(_fin);</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            slowdown.<a class="code" href="classAR_1_1SlowDown.html#a0f7fdbbdaff81b171802ba4d5d659682">readBinary</a>(_fin);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            perturber.readBinary(_fin);</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            info.readBinary(_fin);</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            profile.<a class="code" href="classAR_1_1Profile.html#a6876b1f0f13a035cdcd51d7f5a4bd65d">readBinary</a>(_fin);</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        }</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    };</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;}</div><div class="ttc" id="structAR_1_1Force_html_abcb2ed01aed7b8ce9e10c45a63bd9077"><div class="ttname"><a href="structAR_1_1Force.html#abcb2ed01aed7b8ce9e10c45a63bd9077">AR::Force::acc_in</a></div><div class="ttdeci">Float acc_in[3]</div><div class="ttdoc">total acceleration from all inner particle members of the group </div><div class="ttdef"><b>Definition:</b> force.h:12</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a357fd0ba51c03e4fb25b7c7f86ab5ef7"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a357fd0ba51c03e4fb25b7c7f86ab5ef7">AR::TimeTransformedSymplecticIntegrator::perturber</a></div><div class="ttdeci">Tpert perturber</div><div class="ttdoc">perturber class </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:158</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_a04903afdcfee09b36b30600a2683c99e"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#a04903afdcfee09b36b30600a2683c99e">COMM::ParticleGroup::isOriginFrame</a></div><div class="ttdeci">bool isOriginFrame() const </div><div class="ttdoc">return true if the system is the in their origin frame </div><div class="ttdef"><b>Definition:</b> particle_group.h:281</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a01f24202c09aecd0285a8b5e168379b1"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a01f24202c09aecd0285a8b5e168379b1">AR::TimeTransformedSymplecticIntegrator::getEtotRef</a></div><div class="ttdeci">Float getEtotRef() const </div><div class="ttdoc">Get current total integrated energy. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1657</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_acdbeeada2bb4f8ef82aee8e5574f3beb"><div class="ttname"><a href="classAR_1_1SlowDown.html#acdbeeada2bb4f8ef82aee8e5574f3beb">AR::SlowDown::getSlowDownFactor</a></div><div class="ttdeci">Float getSlowDownFactor() const </div><div class="ttdoc">Get slow-down factor. </div><div class="ttdef"><b>Definition:</b> slow_down.h:114</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a24f338caf7308ceda28fcd7f8a223165"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a24f338caf7308ceda28fcd7f8a223165">AR::TimeTransformedSymplecticIntegrator::integrateToTime</a></div><div class="ttdeci">COMM::BinaryTree&lt; Tparticle &gt; * integrateToTime(const Float _time_end_real)</div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1086</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a0f18041128f371f6c76d87b2684499cb"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a0f18041128f371f6c76d87b2684499cb">AR::TimeTransformedSymplecticIntegrator::writeBackParticlesOriginFrame</a></div><div class="ttdeci">void writeBackParticlesOriginFrame()</div><div class="ttdoc">write back particles to original address </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1607</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_aa562a1c5d18cfff4c0c3fae32d6569fa"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aa562a1c5d18cfff4c0c3fae32d6569fa">AR::TimeTransformedSymplecticIntegrator::particles</a></div><div class="ttdeci">COMM::ParticleGroup&lt; Tparticle, Tpcm &gt; particles</div><div class="ttdoc">particle group manager </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:153</div></div>
<div class="ttc" id="classAR_1_1Profile_html"><div class="ttname"><a href="classAR_1_1Profile.html">AR::Profile</a></div><div class="ttdoc">profiling class for AR integrator </div><div class="ttdef"><b>Definition:</b> AR/profile.h:28</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a627ee2ed40338b50d6462c92ff08219f"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a627ee2ed40338b50d6462c92ff08219f">AR::TimeTransformedSymplecticIntegrator::checkParams</a></div><div class="ttdeci">bool checkParams()</div><div class="ttdoc">check whether parameters values are correct </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:179</div></div>
<div class="ttc" id="classAR_1_1SymplecticStep_html_a7bd554fb4782da4c8a5b56be01877273"><div class="ttname"><a href="classAR_1_1SymplecticStep.html#a7bd554fb4782da4c8a5b56be01877273">AR::SymplecticStep::readBinary</a></div><div class="ttdeci">void readBinary(FILE *_fin)</div><div class="ttdoc">read class data with BINARY format and initial the array </div><div class="ttdef"><b>Definition:</b> symplectic_step.h:343</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a73cfdef4d77dc9a3ea3b673cfde775de"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a73cfdef4d77dc9a3ea3b673cfde775de">AR::TimeTransformedSymplecticIntegrator::getDHSlowDownChangeCum</a></div><div class="ttdeci">Float getDHSlowDownChangeCum() const </div><div class="ttdoc">get cumulative hamiltonian change due to slowdown change </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1702</div></div>
<div class="ttc" id="classCOMM_1_1List_html_a125e4f93ee02b677f8377bd541f2105d"><div class="ttname"><a href="classCOMM_1_1List.html#a125e4f93ee02b677f8377bd541f2105d">COMM::List&lt; Tparticle &gt;::getDataAddress</a></div><div class="ttdeci">Tparticle * getDataAddress() const</div><div class="ttdoc">return member data array address </div><div class="ttdef"><b>Definition:</b> list.h:170</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_a33031aee8edde0d51b0a38446beabb25"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#a33031aee8edde0d51b0a38446beabb25">AR::TimeTransformedSymplecticManager::TimeTransformedSymplecticManager</a></div><div class="ttdeci">TimeTransformedSymplecticManager()</div><div class="ttdoc">class to manager kick drift step </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:38</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_affe5e5681cc87ff9c695059f68106c8c"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#affe5e5681cc87ff9c695059f68106c8c">COMM::ParticleGroup::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clear function. </div><div class="ttdef"><b>Definition:</b> particle_group.h:29</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_a3c37e4d27a9a2828975d5c04175fc149"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#a3c37e4d27a9a2828975d5c04175fc149">AR::TimeTransformedSymplecticManager::interrupt_detection_option</a></div><div class="ttdeci">int interrupt_detection_option</div><div class="ttdoc">maximum step counts </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:32</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_a9841046fae8fbbd01ddfa4c549aaa23d"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#a9841046fae8fbbd01ddfa4c549aaa23d">COMM::ParticleGroup::writeBinary</a></div><div class="ttdeci">void writeBinary(FILE *_fout)</div><div class="ttdoc">write particle data to files (notice original address is lost) </div><div class="ttdef"><b>Definition:</b> particle_group.h:121</div></div>
<div class="ttc" id="namespaceCOMM_html_aa0ca1c24dcb00331c6dca89a0a188fe3af5ddaf0ca7929578b408c909429f68f2"><div class="ttname"><a href="namespaceCOMM.html#aa0ca1c24dcb00331c6dca89a0a188fe3af5ddaf0ca7929578b408c909429f68f2">COMM::ListMode::local</a></div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_ab9436a956d9925171387b0cfe4ffbb0f"><div class="ttname"><a href="classAR_1_1SlowDown.html#ab9436a956d9925171387b0cfe4ffbb0f">AR::SlowDown::initialSlowDownReference</a></div><div class="ttdeci">void initialSlowDownReference(const Float _kappa_ref, const Float _timescale_max)</div><div class="ttdoc">initialize slow-down parameters </div><div class="ttdef"><b>Definition:</b> slow_down.h:44</div></div>
<div class="ttc" id="slow__down_8h_html"><div class="ttname"><a href="slow__down_8h.html">slow_down.h</a></div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a6103fa59192c6de25dd9be66e76d0189"><div class="ttname"><a href="classAR_1_1SlowDown.html#a6103fa59192c6de25dd9be66e76d0189">AR::SlowDown::backupSlowDownFactorAndTimeReal</a></div><div class="ttdeci">int backupSlowDownFactorAndTimeReal(Float *_bk)</div><div class="ttdoc">backup real time and force ratio </div><div class="ttdef"><b>Definition:</b> slow_down.h:177</div></div>
<div class="ttc" id="classAR_1_1Profile_html_ae3afe50f02c55bb640ec60569d9a359a"><div class="ttname"><a href="classAR_1_1Profile.html#ae3afe50f02c55bb640ec60569d9a359a">AR::Profile::writeBinary</a></div><div class="ttdeci">void writeBinary(FILE *_fout)</div><div class="ttdoc">write class data with BINARY format </div><div class="ttdef"><b>Definition:</b> AR/profile.h:72</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a28a6f4109a57453619d93b144943101d"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a28a6f4109a57453619d93b144943101d">AR::TimeTransformedSymplecticIntegrator::getEkin</a></div><div class="ttdeci">Float getEkin() const </div><div class="ttdoc">Get current kinetic energy. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1643</div></div>
<div class="ttc" id="structAR_1_1Force_html"><div class="ttname"><a href="structAR_1_1Force.html">AR::Force</a></div><div class="ttdoc">force class of one particle </div><div class="ttdef"><b>Definition:</b> force.h:10</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_a785c959cd78824f9b7801a6529f96ac6"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#a785c959cd78824f9b7801a6529f96ac6">COMM::ParticleGroup::printColumn</a></div><div class="ttdeci">void printColumn(std::ostream &amp;_fout, const int _width=20)</div><div class="ttdoc">print data of class members using column style </div><div class="ttdef"><b>Definition:</b> particle_group.h:112</div></div>
<div class="ttc" id="classCOMM_1_1List_html_af1c92acd831f62c52f3385a71d6403e7"><div class="ttname"><a href="classCOMM_1_1List.html#af1c92acd831f62c52f3385a71d6403e7">COMM::List&lt; Tparticle &gt;::getSize</a></div><div class="ttdeci">int getSize() const</div><div class="ttdoc">get current member number </div><div class="ttdef"><b>Definition:</b> list.h:151</div></div>
<div class="ttc" id="classCOMM_1_1List_html"><div class="ttname"><a href="classCOMM_1_1List.html">COMM::List</a></div><div class="ttdoc">list class to store and manage a group of member </div><div class="ttdef"><b>Definition:</b> list.h:19</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a4db984abe326fd1a30b3d52f6537e5eb"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a4db984abe326fd1a30b3d52f6537e5eb">AR::TimeTransformedSymplecticIntegrator::initialIntegration</a></div><div class="ttdeci">void initialIntegration(const Float _time_real)</div><div class="ttdoc">initialization for integration </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:742</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_ae891a55d0873158a3e0839c7869bb078"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ae891a55d0873158a3e0839c7869bb078">AR::TimeTransformedSymplecticIntegrator::getEtotFromBackup</a></div><div class="ttdeci">Float getEtotFromBackup(Float *_bk) const </div><div class="ttdoc">get total energy from backup data (ekin+epot) </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1686</div></div>
<div class="ttc" id="classAR_1_1SymplecticStep_html_a191a4dfa707aa4bbe6258c90c6ae80bc"><div class="ttname"><a href="classAR_1_1SymplecticStep.html#a191a4dfa707aa4bbe6258c90c6ae80bc">AR::SymplecticStep::getOrder</a></div><div class="ttdeci">int getOrder() const </div><div class="ttdoc">get Symplectic order </div><div class="ttdef"><b>Definition:</b> symplectic_step.h:329</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_ac437d74b8165f0ada466e1bedca66a58"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#ac437d74b8165f0ada466e1bedca66a58">COMM::ParticleGroup::readBinary</a></div><div class="ttdeci">void readBinary(FILE *_fin)</div><div class="ttdoc">Read particle data from file. </div><div class="ttdef"><b>Definition:</b> particle_group.h:152</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a9a5c7bd3dfff2fd3ab96fd639ec30d27"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a9a5c7bd3dfff2fd3ab96fd639ec30d27">AR::TimeTransformedSymplecticIntegrator::readBinary</a></div><div class="ttdeci">void readBinary(FILE *_fin)</div><div class="ttdoc">read class data with BINARY format and initial the array </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1957</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_ae28ed1ffac4d21b920fdec8b32d1215c"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#ae28ed1ffac4d21b920fdec8b32d1215c">COMM::ParticleGroup::backupParticlePosVel</a></div><div class="ttdeci">int backupParticlePosVel(Float *_bk)</div><div class="ttdoc">Backup member particle position and velocity. </div><div class="ttdef"><b>Definition:</b> particle_group.h:63</div></div>
<div class="ttc" id="classCOMM_1_1List_html_abcdc25c6ecaf2d352583fa75f9fa1180"><div class="ttname"><a href="classCOMM_1_1List.html#abcdc25c6ecaf2d352583fa75f9fa1180">COMM::List::getLastMember</a></div><div class="ttdeci">Ttype &amp; getLastMember()</div><div class="ttdoc">return last member </div><div class="ttdef"><b>Definition:</b> list.h:180</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a72cd3195cd03b8e4b516e8b574e6defb"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a72cd3195cd03b8e4b516e8b574e6defb">AR::TimeTransformedSymplecticIntegrator::writeBinary</a></div><div class="ttdeci">void writeBinary(FILE *_fout)</div><div class="ttdoc">write class data with BINARY format </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1935</div></div>
<div class="ttc" id="information_8h_html"><div class="ttname"><a href="information_8h.html">information.h</a></div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_aa9bc3285b782123da733df7d123a4ad6"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aa9bc3285b782123da733df7d123a4ad6">AR::TimeTransformedSymplecticIntegrator::integrateTwoOneStep</a></div><div class="ttdeci">void integrateTwoOneStep(const Float _ds, Float _time_table[])</div><div class="ttdoc">integration for two body one step </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:938</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_ad24173534adac2b1e58a40de5e525baf"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ad24173534adac2b1e58a40de5e525baf">AR::TimeTransformedSymplecticIntegrator::writeBackSlowDownParticles</a></div><div class="ttdeci">void writeBackSlowDownParticles(const Tptcl &amp;_particle_cm)</div><div class="ttdoc">write back particles with slowdown velocity </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1583</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a83cfa161c5ccb66793e9455fef99da92"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a83cfa161c5ccb66793e9455fef99da92">AR::TimeTransformedSymplecticIntegrator::getEtot</a></div><div class="ttdeci">Float getEtot() const </div><div class="ttdoc">Get current total energy from ekin and epot. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1664</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a45a6ec5453cd66ed15af6d0612d6d1a8"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a45a6ec5453cd66ed15af6d0612d6d1a8">AR::TimeTransformedSymplecticIntegrator::getTime</a></div><div class="ttdeci">Float getTime() const </div><div class="ttdoc">Get current physical time. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1636</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a81522aaa0bf529c877d78ab4c831fb4e"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a81522aaa0bf529c877d78ab4c831fb4e">AR::TimeTransformedSymplecticIntegrator::manager</a></div><div class="ttdeci">TimeTransformedSymplecticManager&lt; Tmethod &gt; * manager</div><div class="ttdoc">integration manager </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:152</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_aaa3a79d58bda3139dc300f0f46bff536"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aaa3a79d58bda3139dc300f0f46bff536">AR::TimeTransformedSymplecticIntegrator::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clear function. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:205</div></div>
<div class="ttc" id="classAR_1_1Profile_html_a54a781c377e38381f311fba9a257340a"><div class="ttname"><a href="classAR_1_1Profile.html#a54a781c377e38381f311fba9a257340a">AR::Profile::step_count_sum</a></div><div class="ttdeci">UInt64 step_count_sum</div><div class="ttdef"><b>Definition:</b> AR/profile.h:31</div></div>
<div class="ttc" id="classCOMM_1_1BinaryTree_html"><div class="ttname"><a href="classCOMM_1_1BinaryTree.html">COMM::BinaryTree&lt; Tparticle &gt;</a></div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html">AR::TimeTransformedSymplecticIntegrator</a></div><div class="ttdoc">Time Transformed Symplectic integrator class for a group of particles. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:114</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a09592b94e586ce90b5c2826c930978f9"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a09592b94e586ce90b5c2826c930978f9">AR::TimeTransformedSymplecticIntegrator::TimeTransformedSymplecticIntegrator</a></div><div class="ttdeci">TimeTransformedSymplecticIntegrator()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:163</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_aefc316aac9438bf9bf6e84aed6c7a952"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aefc316aac9438bf9bf6e84aed6c7a952">AR::TimeTransformedSymplecticIntegrator::restoreIntData</a></div><div class="ttdeci">int restoreIntData(Float *_bk)</div><div class="ttdoc">Restore integration data. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1808</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_aa7335bef5a1e276f0a02c3f40c8c2a3f"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#aa7335bef5a1e276f0a02c3f40c8c2a3f">AR::TimeTransformedSymplecticManager::interaction</a></div><div class="ttdeci">Tmethod interaction</div><div class="ttdoc">1: detect interruption; 0: no detection </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:34</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_af86e63ccc63510fb77c9ce495cb3a263"><div class="ttname"><a href="classAR_1_1SlowDown.html#af86e63ccc63510fb77c9ce495cb3a263">AR::SlowDown::getPertOut</a></div><div class="ttdeci">Float getPertOut() const </div><div class="ttdef"><b>Definition:</b> slow_down.h:140</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html">AR::TimeTransformedSymplecticManager</a></div><div class="ttdoc">Time Transformed Symplectic integrator manager. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:21</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a73d3b8fc6bae672f8f935a8c44545730"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a73d3b8fc6bae672f8f935a8c44545730">AR::TimeTransformedSymplecticIntegrator::printColumn</a></div><div class="ttdeci">void printColumn(std::ostream &amp;_fout, const int _width=20, const int _n_sd=0)</div><div class="ttdoc">print data of class members using column style </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1884</div></div>
<div class="ttc" id="structAR_1_1Force_html_ac66e6a67f66ab3e1d9fa811b83cd016a"><div class="ttname"><a href="structAR_1_1Force.html#ac66e6a67f66ab3e1d9fa811b83cd016a">AR::Force::acc_pert</a></div><div class="ttdeci">Float acc_pert[3]</div><div class="ttdoc">perturbation from outside of the group </div><div class="ttdef"><b>Definition:</b> force.h:13</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_aa871b6ffb269568fa6108c547234f09f"><div class="ttname"><a href="classAR_1_1SlowDown.html#aa871b6ffb269568fa6108c547234f09f">AR::SlowDown::printColumnTitle</a></div><div class="ttdeci">void printColumnTitle(std::ostream &amp;_fout, const int _width=20)</div><div class="ttdoc">print titles of class members using column style </div><div class="ttdef"><b>Definition:</b> slow_down.h:216</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_aef58e7b1ec25846a506b9b0281522a1f"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aef58e7b1ec25846a506b9b0281522a1f">AR::TimeTransformedSymplecticIntegrator::updateSlowDownAndCorrectEnergy</a></div><div class="ttdeci">void updateSlowDownAndCorrectEnergy()</div><div class="ttdoc">update slowdown factor based on perturbation and record slowdown energy change </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:828</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a9a08a4212d82104f92a7b870f5d523fb"><div class="ttname"><a href="classAR_1_1SlowDown.html#a9a08a4212d82104f92a7b870f5d523fb">AR::SlowDown::restoreSlowDownFactorAndTimeReal</a></div><div class="ttdeci">int restoreSlowDownFactorAndTimeReal(Float *_bk)</div><div class="ttdoc">restore real time and force ratio </div><div class="ttdef"><b>Definition:</b> slow_down.h:188</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_a8118a3c955b14d3924269d3b8b6e953b"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#a8118a3c955b14d3924269d3b8b6e953b">COMM::ParticleGroup::cm</a></div><div class="ttdeci">Tpcm cm</div><div class="ttdef"><b>Definition:</b> particle_group.h:19</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_aab55b52156245634a8d78c7728b5c802"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#aab55b52156245634a8d78c7728b5c802">AR::TimeTransformedSymplecticIntegrator::~TimeTransformedSymplecticIntegrator</a></div><div class="ttdeci">~TimeTransformedSymplecticIntegrator()</div><div class="ttdoc">destructor </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:233</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_a468331841b3d06894c4fb450891c7c2e"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#a468331841b3d06894c4fb450891c7c2e">AR::TimeTransformedSymplecticManager::readBinary</a></div><div class="ttdeci">void readBinary(FILE *_fin)</div><div class="ttdoc">read class data with BINARY format and initial the array </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:78</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a5c45f143d6a385e8fcd353805cec2215"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5c45f143d6a385e8fcd353805cec2215">AR::TimeTransformedSymplecticIntegrator::profile</a></div><div class="ttdeci">Profile profile</div><div class="ttdoc">profile to measure the performance </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:160</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_a46a5186631babb11c1be415ba740315d"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#a46a5186631babb11c1be415ba740315d">COMM::ParticleGroup::shiftToCenterOfMassFrame</a></div><div class="ttdeci">void shiftToCenterOfMassFrame()</div><div class="ttdoc">shift particle to their c.m. frame </div><div class="ttdef"><b>Definition:</b> particle_group.h:205</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a1f220a59d9bd080161b6483fc11e843c"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a1f220a59d9bd080161b6483fc11e843c">AR::TimeTransformedSymplecticIntegrator::slowdown</a></div><div class="ttdeci">SlowDown slowdown</div><div class="ttdoc">slowdown of the system </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:157</div></div>
<div class="ttc" id="classAR_1_1Profile_html_a848512d98c7ca1339f490523414100b3"><div class="ttname"><a href="classAR_1_1Profile.html#a848512d98c7ca1339f490523414100b3">AR::Profile::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> AR/profile.h:40</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_a8921a86541d095de3a8685f4aad2da48"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#a8921a86541d095de3a8685f4aad2da48">AR::TimeTransformedSymplecticManager::checkParams</a></div><div class="ttdeci">bool checkParams()</div><div class="ttdoc">check whether parameters values are correct </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:48</div></div>
<div class="ttc" id="classCOMM_1_1BinaryTree_html_a7f522c71405aed42888caaf4f8eb45eb"><div class="ttname"><a href="classCOMM_1_1BinaryTree.html#a7f522c71405aed42888caaf4f8eb45eb">COMM::BinaryTree::processRootIter</a></div><div class="ttdeci">T processRootIter(T &amp;_dat, ProcessFunctionRoot&lt; T &gt; _f)</div><div class="ttdoc">Process root data and return result iteratively. </div><div class="ttdef"><b>Definition:</b> binary_tree.h:623</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_a8163146e05f0fdd4364a019912cd057f"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#a8163146e05f0fdd4364a019912cd057f">AR::TimeTransformedSymplecticManager::step</a></div><div class="ttdeci">SymplecticStep step</div><div class="ttdoc">class contain interaction function </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:35</div></div>
<div class="ttc" id="classAR_1_1Profile_html_a0279e942777d4e76588cd8cca5ffba36"><div class="ttname"><a href="classAR_1_1Profile.html#a0279e942777d4e76588cd8cca5ffba36">AR::Profile::step_count</a></div><div class="ttdeci">UInt64 step_count</div><div class="ttdef"><b>Definition:</b> AR/profile.h:33</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a1f153e07b27376eb86bffb7756199b6a"><div class="ttname"><a href="classAR_1_1SlowDown.html#a1f153e07b27376eb86bffb7756199b6a">AR::SlowDown::getSlowDownFactorOrigin</a></div><div class="ttdeci">Float getSlowDownFactorOrigin() const </div><div class="ttdoc">Get original slow-down factor. </div><div class="ttdef"><b>Definition:</b> slow_down.h:122</div></div>
<div class="ttc" id="namespaceCOMM_html_aa0ca1c24dcb00331c6dca89a0a188fe3a12cba3ee81cf4a793796a51b6327c678"><div class="ttname"><a href="namespaceCOMM.html#aa0ca1c24dcb00331c6dca89a0a188fe3a12cba3ee81cf4a793796a51b6327c678">COMM::ListMode::copy</a></div></div>
<div class="ttc" id="classAR_1_1Profile_html_a6876b1f0f13a035cdcd51d7f5a4bd65d"><div class="ttname"><a href="classAR_1_1Profile.html#a6876b1f0f13a035cdcd51d7f5a4bd65d">AR::Profile::readBinary</a></div><div class="ttdeci">void readBinary(FILE *_fin)</div><div class="ttdoc">read class data with BINARY format and initial the array </div><div class="ttdef"><b>Definition:</b> AR/profile.h:79</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a05cb058656662b84f4a2af3600916363"><div class="ttname"><a href="classAR_1_1SlowDown.html#a05cb058656662b84f4a2af3600916363">AR::SlowDown::driftRealTime</a></div><div class="ttdeci">void driftRealTime(const Float _dt_int)</div><div class="ttdoc">drift real time </div><div class="ttdef"><b>Definition:</b> slow_down.h:65</div></div>
<div class="ttc" id="list_8h_html"><div class="ttname"><a href="list_8h.html">list.h</a></div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_a9f6811189392b0ff828cab43124d413c"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#a9f6811189392b0ff828cab43124d413c">AR::TimeTransformedSymplecticManager::energy_error_relative_max</a></div><div class="ttdeci">Float energy_error_relative_max</div><div class="ttdoc">maximum time error (absolute), should be positive and larger than round-off error ...</div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:24</div></div>
<div class="ttc" id="classCOMM_1_1List_html_af3b49aeea643123fe2428af456c3fc77"><div class="ttname"><a href="classCOMM_1_1List.html#af3b49aeea643123fe2428af456c3fc77">COMM::List&lt; Tparticle &gt;::getSizeMax</a></div><div class="ttdeci">int getSizeMax() const</div><div class="ttdoc">Get maximum member number allow to store. </div><div class="ttdef"><b>Definition:</b> list.h:209</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_ad5c3d75646774b843eb1eefc86f10b52"><div class="ttname"><a href="classAR_1_1SlowDown.html#ad5c3d75646774b843eb1eefc86f10b52">AR::SlowDown::getRealTime</a></div><div class="ttdeci">Float getRealTime() const </div><div class="ttdoc">get real time value </div><div class="ttdef"><b>Definition:</b> slow_down.h:57</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_ac5bd5371a46e342f8044178ae9dff05a"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#ac5bd5371a46e342f8044178ae9dff05a">AR::TimeTransformedSymplecticManager::time_step_real_min</a></div><div class="ttdeci">Float time_step_real_min</div><div class="ttdoc">maximum energy error requirement </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:25</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html"><div class="ttname"><a href="classAR_1_1SlowDown.html">AR::SlowDown</a></div><div class="ttdoc">Slow-down parameter control class. </div><div class="ttdef"><b>Definition:</b> slow_down.h:11</div></div>
<div class="ttc" id="classCOMM_1_1List_html_a432ae1abc33765666f627149c0982c3a"><div class="ttname"><a href="classCOMM_1_1List.html#a432ae1abc33765666f627149c0982c3a">COMM::List&lt; Tparticle &gt;::getOriginAddressArray</a></div><div class="ttdeci">Tparticle ** getOriginAddressArray() const</div><div class="ttdoc">return member original address array </div><div class="ttdef"><b>Definition:</b> list.h:175</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a810d3b067eb342d28e6f97c7041b96c0"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a810d3b067eb342d28e6f97c7041b96c0">AR::TimeTransformedSymplecticIntegrator::printColumnTitle</a></div><div class="ttdeci">void printColumnTitle(std::ostream &amp;_fout, const int _width=20, const int _n_sd=0)</div><div class="ttdoc">print titles of class members using column style </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1848</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a885e6a131ed7cc37f420cc59162f4244"><div class="ttname"><a href="classAR_1_1SlowDown.html#a885e6a131ed7cc37f420cc59162f4244">AR::SlowDown::getPertIn</a></div><div class="ttdeci">Float getPertIn() const </div><div class="ttdef"><b>Definition:</b> slow_down.h:136</div></div>
<div class="ttc" id="classCOMM_1_1Binary_html_a62fdf14365f58412fde6199a31f87152"><div class="ttname"><a href="classCOMM_1_1Binary.html#a62fdf14365f58412fde6199a31f87152">COMM::Binary::semi</a></div><div class="ttdeci">Float semi</div><div class="ttdef"><b>Definition:</b> binary_tree.h:13</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_a2d92a2c26818cf9820ea13026091fb81"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#a2d92a2c26818cf9820ea13026091fb81">COMM::ParticleGroup::printColumnTitle</a></div><div class="ttdeci">void printColumnTitle(std::ostream &amp;_fout, const int _width=20)</div><div class="ttdoc">print titles of class members using column style </div><div class="ttdef"><b>Definition:</b> particle_group.h:102</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_aa4a3ca60109ddaf0124d34109f18ddb9"><div class="ttname"><a href="classAR_1_1SlowDown.html#aa4a3ca60109ddaf0124d34109f18ddb9">AR::SlowDown::getBackupDataSize</a></div><div class="ttdeci">int getBackupDataSize() const </div><div class="ttdoc">get backup data size </div><div class="ttdef"><b>Definition:</b> slow_down.h:169</div></div>
<div class="ttc" id="classCOMM_1_1List_html_aceaeddd10f8a05984f25a258a48c2620"><div class="ttname"><a href="classCOMM_1_1List.html#aceaeddd10f8a05984f25a258a48c2620">COMM::List::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clear function. </div><div class="ttdef"><b>Definition:</b> list.h:76</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_af1a559da78388cde7e6a33bdb2ef9614"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#af1a559da78388cde7e6a33bdb2ef9614">AR::TimeTransformedSymplecticIntegrator::info</a></div><div class="ttdeci">Tinfo info</div><div class="ttdoc">information of the system </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:159</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a0f7fdbbdaff81b171802ba4d5d659682"><div class="ttname"><a href="classAR_1_1SlowDown.html#a0f7fdbbdaff81b171802ba4d5d659682">AR::SlowDown::readBinary</a></div><div class="ttdeci">void readBinary(FILE *_fin)</div><div class="ttdoc">read class data with BINARY format </div><div class="ttdef"><b>Definition:</b> slow_down.h:158</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a96bbb1913537669fc970a149028acdfd"><div class="ttname"><a href="classAR_1_1SlowDown.html#a96bbb1913537669fc970a149028acdfd">AR::SlowDown::setRealTime</a></div><div class="ttdeci">void setRealTime(const Float _time_real)</div><div class="ttdoc">set real time value </div><div class="ttdef"><b>Definition:</b> slow_down.h:52</div></div>
<div class="ttc" id="classAR_1_1Profile_html_ad6328050e002bd13b2848706ceb76bb2"><div class="ttname"><a href="classAR_1_1Profile.html#ad6328050e002bd13b2848706ceb76bb2">AR::Profile::step_count_tsyn_sum</a></div><div class="ttdeci">UInt64 step_count_tsyn_sum</div><div class="ttdef"><b>Definition:</b> AR/profile.h:32</div></div>
<div class="ttc" id="classCOMM_1_1List_html_a0f3dd09ceff0ce9b3ffd15f48a9ea9c4"><div class="ttname"><a href="classCOMM_1_1List.html#a0f3dd09ceff0ce9b3ffd15f48a9ea9c4">COMM::List::resizeNoInitialize</a></div><div class="ttdeci">void resizeNoInitialize(const int _n)</div><div class="ttdoc">increase size without initialization </div><div class="ttdef"><b>Definition:</b> list.h:268</div></div>
<div class="ttc" id="classCOMM_1_1List_html_a610a134731844b13df4b22ef0d9ad603"><div class="ttname"><a href="classCOMM_1_1List.html#a610a134731844b13df4b22ef0d9ad603">COMM::List::increaseSizeNoInitialize</a></div><div class="ttdeci">void increaseSizeNoInitialize(const int _n)</div><div class="ttdoc">increase size without initialization </div><div class="ttdef"><b>Definition:</b> list.h:246</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_aa7e0c949d709205186148cab38e5cd96"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#aa7e0c949d709205186148cab38e5cd96">COMM::ParticleGroup::restoreParticlePosVel</a></div><div class="ttdeci">int restoreParticlePosVel(Float *_bk)</div><div class="ttdoc">restore member particle position and velocity </div><div class="ttdef"><b>Definition:</b> particle_group.h:82</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_acb82fbf04578955d8dcf8035c0f97ee3"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#acb82fbf04578955d8dcf8035c0f97ee3">AR::TimeTransformedSymplecticIntegrator::integrateOneStep</a></div><div class="ttdeci">void integrateOneStep(const Float _ds, Float _time_table[])</div><div class="ttdoc">integration for one step </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:863</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_ab16cecae3e9445901dd72cdc0e1d5115"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ab16cecae3e9445901dd72cdc0e1d5115">AR::TimeTransformedSymplecticIntegrator::getBackupDataSize</a></div><div class="ttdeci">int getBackupDataSize() const </div><div class="ttdoc">get backup data size </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1761</div></div>
<div class="ttc" id="namespaceAR_html_a67c328d9c95dd7715ecd102207029196a334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="namespaceAR.html#a67c328d9c95dd7715ecd102207029196a334c4a4c42fdb79d7ebc3e73b517e6f8">AR::FixStepOption::none</a></div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_ab360e8472572d3df9e5dcc5dcfa2a548"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#ab360e8472572d3df9e5dcc5dcfa2a548">AR::TimeTransformedSymplecticManager::writeBinary</a></div><div class="ttdeci">void writeBinary(FILE *_fout)</div><div class="ttdoc">write class data with BINARY format </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:68</div></div>
<div class="ttc" id="Float_8h_html_a74e8443ef1ba64fac1dbb8f9f2c32eef"><div class="ttname"><a href="Float_8h.html#a74e8443ef1ba64fac1dbb8f9f2c32eef">Float</a></div><div class="ttdeci">double Float</div><div class="ttdef"><b>Definition:</b> Float.h:25</div></div>
<div class="ttc" id="namespaceAR_html_a67c328d9c95dd7715ecd102207029196af9f90eeaf400d228facde6bc48da5cfb"><div class="ttname"><a href="namespaceAR.html#a67c328d9c95dd7715ecd102207029196af9f90eeaf400d228facde6bc48da5cfb">AR::FixStepOption::always</a></div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a7cae8bcc039bb158497e2f9bb6efbd78"><div class="ttname"><a href="classAR_1_1SlowDown.html#a7cae8bcc039bb158497e2f9bb6efbd78">AR::SlowDown::calcSlowDownFactor</a></div><div class="ttdeci">Float calcSlowDownFactor()</div><div class="ttdoc">calculate slowdown factor based on perturbation and inner acceleration </div><div class="ttdef"><b>Definition:</b> slow_down.h:94</div></div>
<div class="ttc" id="classCOMM_1_1List_html_aaddc8ba775e2a6504eb393d7d0c2235b"><div class="ttname"><a href="classCOMM_1_1List.html#aaddc8ba775e2a6504eb393d7d0c2235b">COMM::List&lt; Tparticle &gt;::isModified</a></div><div class="ttdeci">bool isModified() const</div><div class="ttdoc">Get modified status. </div><div class="ttdef"><b>Definition:</b> list.h:457</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_ad6ac699eac841ad74a329cb7087ed5aa"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#ad6ac699eac841ad74a329cb7087ed5aa">AR::TimeTransformedSymplecticManager::print</a></div><div class="ttdeci">void print(std::ostream &amp;_fout) const </div><div class="ttdoc">print parameters </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:90</div></div>
<div class="ttc" id="force_8h_html"><div class="ttname"><a href="force_8h.html">force.h</a></div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a710d1c21a65f80a511a33ef3da325b33"><div class="ttname"><a href="classAR_1_1SlowDown.html#a710d1c21a65f80a511a33ef3da325b33">AR::SlowDown::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">clear function </div><div class="ttdef"><b>Definition:</b> slow_down.h:30</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a5a5a148b048d869e46e8eb015f44eaef"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5a5a148b048d869e46e8eb015f44eaef">AR::TimeTransformedSymplecticIntegrator::resetDESlowDownChangeCum</a></div><div class="ttdeci">void resetDESlowDownChangeCum()</div><div class="ttdoc">reset cumulative energy change due to slowdown change </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1691</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a38d0b2d128d6356c1e35ee574ae13c53"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a38d0b2d128d6356c1e35ee574ae13c53">AR::TimeTransformedSymplecticIntegrator::getDESlowDownChangeCum</a></div><div class="ttdeci">Float getDESlowDownChangeCum() const </div><div class="ttdoc">get cumulative energy change due to slowdown change </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1697</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_afc4f679dc3bd99fa80e4b29677bc64f3"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#afc4f679dc3bd99fa80e4b29677bc64f3">AR::TimeTransformedSymplecticIntegrator::getEnergyErrorFromBackup</a></div><div class="ttdeci">Float getEnergyErrorFromBackup(Float *_bk) const </div><div class="ttdoc">get energy error from backup data </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1676</div></div>
<div class="ttc" id="classAR_1_1SymplecticStep_html_ac690aed0e148f94b81c5b944de0c680f"><div class="ttname"><a href="classAR_1_1SymplecticStep.html#ac690aed0e148f94b81c5b944de0c680f">AR::SymplecticStep::writeBinary</a></div><div class="ttdeci">void writeBinary(FILE *_fout)</div><div class="ttdoc">write class data with BINARY format </div><div class="ttdef"><b>Definition:</b> symplectic_step.h:336</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html">COMM::ParticleGroup</a></div><div class="ttdoc">Particle group class to store and manage a group of particle. </div><div class="ttdef"><b>Definition:</b> particle_group.h:13</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_ae6aeae77c0ba7d3fe9a48e55c8db4c82"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#ae6aeae77c0ba7d3fe9a48e55c8db4c82">COMM::ParticleGroup::calcCenterOfMass</a></div><div class="ttdeci">void calcCenterOfMass()</div><div class="ttdoc">calculate center-of-mass </div><div class="ttdef"><b>Definition:</b> particle_group.h:252</div></div>
<div class="ttc" id="classCOMM_1_1BinaryTree_html_ae05cbd6fc87aebd60f87fa37db6ed2a2"><div class="ttname"><a href="classCOMM_1_1BinaryTree.html#ae05cbd6fc87aebd60f87fa37db6ed2a2">COMM::BinaryTree::getMemberN</a></div><div class="ttdeci">int getMemberN() const </div><div class="ttdoc">get total number of members </div><div class="ttdef"><b>Definition:</b> binary_tree.h:572</div></div>
<div class="ttc" id="Float_8h_html_a853ff12111317b68c02ac40cb56c30b2"><div class="ttname"><a href="Float_8h.html#a853ff12111317b68c02ac40cb56c30b2">ROUND_OFF_ERROR_LIMIT</a></div><div class="ttdeci">const Float ROUND_OFF_ERROR_LIMIT</div><div class="ttdef"><b>Definition:</b> Float.h:28</div></div>
<div class="ttc" id="classCOMM_1_1List_html_a53cc90f6633ba9fed844442fc5b36b47"><div class="ttname"><a href="classCOMM_1_1List.html#a53cc90f6633ba9fed844442fc5b36b47">COMM::List&lt; Tparticle &gt;::getMode</a></div><div class="ttdeci">ListMode getMode() const</div><div class="ttdef"><b>Definition:</b> list.h:155</div></div>
<div class="ttc" id="classCOMM_1_1List_html_afe063c29e3ae8df95f65db67d7d8ba81"><div class="ttname"><a href="classCOMM_1_1List.html#afe063c29e3ae8df95f65db67d7d8ba81">COMM::List&lt; Tparticle &gt;::setModifiedFalse</a></div><div class="ttdeci">void setModifiedFalse()</div><div class="ttdoc">Reset modified status to false. </div><div class="ttdef"><b>Definition:</b> list.h:462</div></div>
<div class="ttc" id="AR_2profile_8h_html"><div class="ttname"><a href="AR_2profile_8h.html">profile.h</a></div></div>
<div class="ttc" id="classAR_1_1Profile_html_a40692f5fa715489d67346f2a3942f1b4"><div class="ttname"><a href="classAR_1_1Profile.html#a40692f5fa715489d67346f2a3942f1b4">AR::Profile::printColumn</a></div><div class="ttdeci">void printColumn(std::ostream &amp;_fout, const int _width=20)</div><div class="ttdoc">print data of class members using column style </div><div class="ttdef"><b>Definition:</b> AR/profile.h:62</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_ad9d82c4c1565d944c64a1a48961980e6"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ad9d82c4c1565d944c64a1a48961980e6">AR::TimeTransformedSymplecticIntegrator::correctCenterOfMassDrift</a></div><div class="ttdeci">void correctCenterOfMassDrift()</div><div class="ttdoc">correct CM drift </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1540</div></div>
<div class="ttc" id="classAR_1_1SymplecticStep_html_a19bd3176dd1b853e19023288d41ee532"><div class="ttname"><a href="classAR_1_1SymplecticStep.html#a19bd3176dd1b853e19023288d41ee532">AR::SymplecticStep::print</a></div><div class="ttdeci">void print(std::ostream &amp;_fout) const </div><div class="ttdoc">print parameters </div><div class="ttdef"><b>Definition:</b> symplectic_step.h:359</div></div>
<div class="ttc" id="classCOMM_1_1ParticleGroup_html_a1f2bf3c79eca0f4eaa338c3191b92d2c"><div class="ttname"><a href="classCOMM_1_1ParticleGroup.html#a1f2bf3c79eca0f4eaa338c3191b92d2c">COMM::ParticleGroup::getBackupDataSize</a></div><div class="ttdeci">int getBackupDataSize() const </div><div class="ttdoc">get backup data size </div><div class="ttdef"><b>Definition:</b> particle_group.h:55</div></div>
<div class="ttc" id="classAR_1_1SymplecticStep_html"><div class="ttname"><a href="classAR_1_1SymplecticStep.html">AR::SymplecticStep</a></div><div class="ttdoc">class to manager symplectic KD steps </div><div class="ttdef"><b>Definition:</b> symplectic_step.h:10</div></div>
<div class="ttc" id="Float_8h_html_aa0a42312a91949f0a96dd9fb22add592"><div class="ttname"><a href="Float_8h.html#aa0a42312a91949f0a96dd9fb22add592">to_int</a></div><div class="ttdeci">#define to_int(x)</div><div class="ttdef"><b>Definition:</b> Float.h:26</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_af51100c5b050b9042150be1a0bb3a8e5"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#af51100c5b050b9042150be1a0bb3a8e5">AR::TimeTransformedSymplecticManager::slowdown_timescale_max</a></div><div class="ttdeci">Float slowdown_timescale_max</div><div class="ttdoc">slowdown perturbation /inner ratio reference factor </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:30</div></div>
<div class="ttc" id="classAR_1_1Profile_html_ae30eb312e2c4399bdfd0b4c76b03e2d9"><div class="ttname"><a href="classAR_1_1Profile.html#ae30eb312e2c4399bdfd0b4c76b03e2d9">AR::Profile::step_count_tsyn</a></div><div class="ttdeci">UInt64 step_count_tsyn</div><div class="ttdef"><b>Definition:</b> AR/profile.h:34</div></div>
<div class="ttc" id="namespaceAR_html"><div class="ttname"><a href="namespaceAR.html">AR</a></div><div class="ttdoc">Algorithmic regularization chain (ARC) namespace. </div><div class="ttdef"><b>Definition:</b> force.h:5</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_a799160bafccc5988e5536a02000ec58a"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#a799160bafccc5988e5536a02000ec58a">AR::TimeTransformedSymplecticManager::time_error_max_real</a></div><div class="ttdeci">Float time_error_max_real</div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:23</div></div>
<div class="ttc" id="symplectic__step_8h_html"><div class="ttname"><a href="symplectic__step_8h.html">symplectic_step.h</a></div></div>
<div class="ttc" id="classCOMM_1_1List_html_a7f125554959409d40217deb7402c0de9"><div class="ttname"><a href="classCOMM_1_1List.html#a7f125554959409d40217deb7402c0de9">COMM::List::reserveMem</a></div><div class="ttdeci">void reserveMem(const int _nmax)</div><div class="ttdoc">Memory allocation for storing members. </div><div class="ttdef"><b>Definition:</b> list.h:48</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_ac00641c72ad0f21c9796e8e6cb574530"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#ac00641c72ad0f21c9796e8e6cb574530">AR::TimeTransformedSymplecticIntegrator::reserveIntegratorMem</a></div><div class="ttdeci">void reserveIntegratorMem()</div><div class="ttdoc">reserve memory for force </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:190</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a6cd74146fe2723d5680ae47d38869237"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a6cd74146fe2723d5680ae47d38869237">AR::TimeTransformedSymplecticIntegrator::getEnergyError</a></div><div class="ttdeci">Float getEnergyError() const </div><div class="ttdoc">get energy error </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1671</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a0db82b51fb13faabb3350b5f97f6cfae"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a0db82b51fb13faabb3350b5f97f6cfae">AR::TimeTransformedSymplecticIntegrator::getEtotRefFromBackup</a></div><div class="ttdeci">Float getEtotRefFromBackup(Float *_bk) const </div><div class="ttdoc">get integrated energy from backup data </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1681</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_aad85683de34ff2da23215cf26ff94f9b"><div class="ttname"><a href="classAR_1_1SlowDown.html#aad85683de34ff2da23215cf26ff94f9b">AR::SlowDown::printColumn</a></div><div class="ttdeci">void printColumn(std::ostream &amp;_fout, const int _width=20)</div><div class="ttdoc">print data of class members using column style </div><div class="ttdef"><b>Definition:</b> slow_down.h:228</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a9abc72ad076344e049c5b2505858316b"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a9abc72ad076344e049c5b2505858316b">AR::TimeTransformedSymplecticIntegrator::getEpot</a></div><div class="ttdeci">Float getEpot() const </div><div class="ttdoc">Get current potential energy. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1650</div></div>
<div class="ttc" id="classAR_1_1Profile_html_a1b5aebbb911d06727642ccf97eca9c31"><div class="ttname"><a href="classAR_1_1Profile.html#a1b5aebbb911d06727642ccf97eca9c31">AR::Profile::printColumnTitle</a></div><div class="ttdeci">void printColumnTitle(std::ostream &amp;_fout, const int _width=20)</div><div class="ttdoc">print titles of class members using column style </div><div class="ttdef"><b>Definition:</b> AR/profile.h:50</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a3ba67fc16c6ca3c9e240350c43a52fd2"><div class="ttname"><a href="classAR_1_1SlowDown.html#a3ba67fc16c6ca3c9e240350c43a52fd2">AR::SlowDown::writeBinary</a></div><div class="ttdeci">void writeBinary(FILE *_fout)</div><div class="ttdoc">write class data with BINARY format </div><div class="ttdef"><b>Definition:</b> slow_down.h:151</div></div>
<div class="ttc" id="classAR_1_1SlowDown_html_a43c4636ed1a5fe2acad80dfff75d0677"><div class="ttname"><a href="classAR_1_1SlowDown.html#a43c4636ed1a5fe2acad80dfff75d0677">AR::SlowDown::increaseUpdateTimeOnePeriod</a></div><div class="ttdeci">void increaseUpdateTimeOnePeriod()</div><div class="ttdoc">advance update time by one period </div><div class="ttdef"><b>Definition:</b> slow_down.h:80</div></div>
<div class="ttc" id="classCOMM_1_1List_html_a10c70f9a45d06c2589898cbaf1e4fbf8"><div class="ttname"><a href="classCOMM_1_1List.html#a10c70f9a45d06c2589898cbaf1e4fbf8">COMM::List::setMode</a></div><div class="ttdeci">void setMode(const ListMode _mode)</div><div class="ttdoc">set mode </div><div class="ttdef"><b>Definition:</b> list.h:39</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticIntegrator_html_a5fc16fdc3e8d304c33e6a2d22dfd1e52"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticIntegrator.html#a5fc16fdc3e8d304c33e6a2d22dfd1e52">AR::TimeTransformedSymplecticIntegrator::backupIntData</a></div><div class="ttdeci">int backupIntData(Float *_bk)</div><div class="ttdoc">Backup integration data. </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:1779</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_a11b8c70a74163d251c510aa51db8d758"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#a11b8c70a74163d251c510aa51db8d758">AR::TimeTransformedSymplecticManager::slowdown_pert_ratio_ref</a></div><div class="ttdeci">Float slowdown_pert_ratio_ref</div><div class="ttdoc">minimum real time step allown </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:26</div></div>
<div class="ttc" id="classAR_1_1TimeTransformedSymplecticManager_html_a21bbe24b1e3ed94107a7532836352021"><div class="ttname"><a href="classAR_1_1TimeTransformedSymplecticManager.html#a21bbe24b1e3ed94107a7532836352021">AR::TimeTransformedSymplecticManager::step_count_max</a></div><div class="ttdeci">long long unsigned int step_count_max</div><div class="ttdoc">slowdown maximum timescale to calculate maximum slowdown factor </div><div class="ttdef"><b>Definition:</b> symplectic_integrator.h:31</div></div>
<div class="ttc" id="particle__group_8h_html"><div class="ttname"><a href="particle__group_8h.html">particle_group.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aadd25e79ec57c264f03493d9fa9fb54.html">AR</a></li><li class="navelem"><a class="el" href="symplectic__integrator_8h.html">symplectic_integrator.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
